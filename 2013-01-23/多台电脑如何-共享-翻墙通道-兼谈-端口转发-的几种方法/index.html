<!DOCTYPE html>
<html>
  <head>
  <title>多台电脑如何【共享】翻墙通道——兼谈【端口转发】的几种方法 – 觀點 – 從草根到大師 git.io/JJCxS</title>

      <meta charset="utf-8" />
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>

    
    <meta name="description" content="

      多台电脑如何【共享】翻墙通道——兼谈【端口转发】的几种方法  
  
    
      
    
  
  
     ★引子 
  元旦前后，俺写了《  如何隐藏你的踪迹，避免跨省追捕  》系列的第6、7篇——《用虚拟机隐匿公网IP》。之后有不少网友到博客留言，询问如何让不同虚拟机的软件共享翻墙代理。  所以，俺今天就来聊一聊“多台电脑共享翻墙通道”这个话题。今天介绍的招数，既可以在不同虚拟机之间共享翻墙通道，也可以在不同的实体机（包括PC、平板、手机）之间共享翻墙通道。  
       
        ★预备知识 ＆ 准备工作 
  考虑到俺博客的读者，有很多人【不是】IT 技术人员。所以，俺先通俗地扫盲若干基础知识。        ◇啥是“翻墙”？ 
  如果你对“翻墙”还不太了解，建议你先看看俺写的《  如何翻墙  》一文。这篇扫盲教程可以说是面面俱到，很适合翻墙方面的新手入门。        ◇啥是“代理”？ 
  “代理”好比是一个中转站，可以中转你的上网数据流量，以此来避开 GFW 这堵墙。  翻墙代理通常包括两部分：代理软件，代理服务器。代理软件安装在你的电脑上，代理服务器通常都位于墙外（也就是境外）。当你通过代理上网时，你的浏览器并不是直接连到目标网站。而是通过如下几个步骤：  1. 浏览器发送数据到代理软件  2. 代理软件把你的数据发送到墙外的代理服务器  3. 代理服务器发送数据到目标网站        ◇啥是“监听端口”？ 
  代理软件要正常工作，通常都需要开启一个“监听端口”。浏览器通过这个“监听端口”来跟代理软件建立连接。只有建立了连接，浏览器才能把数据发送到代理软件上。端口号是一个数字，范围在 
   1
   至 
   65535
   之间。        ◇如何看本机开启的监听端口？ 
  对于 Windows 系统，在命令行窗口（先运行 cmd 就会出现命令行窗口）运行如下命令，可以看到本机开启的【所有】监听端口。      netstat -an | find "LISTEN"    
  刚才有读者在留言中提问，俺再补充一下。用 
   netstat
   的 
   o
   选项可以看到每个监听端口分别是【哪个进程】开启滴。命令如下      netstat -ano | find "LISTEN"    
  对于 POSIX 系统（Linux ＆ UNIX），把上述命令中的 
   find
   改为 
   grep
   ，具体如下：      netstat -an | grep "LISTEN"    
       ◇什么是监听端口的“绑定地址”？ 
  以俺手头的虚拟机为例，执行刚才那个命令后，会显示如下输出      TCP  127.0.0.1:8118  0.0.0.0:0  LISTENING    
  其中的 
   127.0.0.1
   表示这个监听端口绑定的网卡地址，而 
   8118
   表示监听的端口号。所谓的“绑定地址”，意思就是说，这个监听端口只接受来自该网卡的连接。  因为 
   127.0.0.1
   表示本机网卡地址；所以，绑定在 
   127.0.0.1
   表示该监听端口只接受来自本机的连接。  如果要让某个监听端口接受任意连接（包括外部电脑的连接），把绑定地址设置为 
   0.0.0.0
   即可。        ◇小心防火墙的配置 
  在《  用虚拟机隐匿公网IP  》一文，俺就特别用红字，提醒大伙儿要小心防火墙的设置。结果还是有很多人因为防火墙的问题而中招，功亏一篑。  俺再啰嗦一下：  要特别小心操作系统中防火墙的设置  。很多人是因为防火墙没设好，导致代理无法连通。  如果你使用本文介绍的招数，却总是搞不定，可以参考下面的教程，用 netcat 诊断一下。  《  扫盲 netcat（网猫）的 N 种用法——从“网络诊断”到“系统入侵”  》         ★如何共享【代理类】的翻墙工具？ 
       ◇问题 
  大部分翻墙代理都会提供一个 TCP 的代理端口（就是刚才说的“监听端口”）。问题在于：很多翻墙代理的代理端口都绑定在 
   127.0.0.1
   上。也就是说，这个代理只能被本机的软件使用，外部电脑的软件无法连接到该端口。        ◇解决方案之“修改配置” 
  最简单的解决方案，就是修改翻墙软件的配置，让代理端口绑定到 
   0.0.0.0
   上。   
   自由门
    到它的设置界面，点“更多设置”，然后勾选“用自由门做服务器”，可以把监听端口绑定到 
   0.0.0.0
     
   GoAgent
    GoAgent 的配置信息存储在 
   proxy.ini
   文件中。打开该文件找到 
   [listen]
   字段，然后把该字段下面的 
   127.0.0.1
   改为 
   0.0.0.0
   即可。   可惜的是，很多翻墙软件都没有提供配置文件让你修改监听端口绑定的地址。所以，俺下面传授一个通用的招数，【无需】修改配置文件，可以【 
   搞定任何翻墙代理
   】，让它的监听端口被外部电脑使用。        ◇解决方案之“端口转发” 
  所谓的“端口转发”，通俗地说就是让 A 监听端口的数据转发到 B 监听端口。  B 监听端口就是你的翻墙软件原先开启的端口  A 监听端口是新开的，而且绑定地址是 
   0.0.0.0
    如此一来，外部电脑就可以用 A 端口作为代理的端口，数据都发给 A 端口，然后利用“端口转发”功能，把数据转向 B 端口（也就是翻墙工具自身的端口）         ★如何搞【端口转发】？ 
  （这招是本文的重点，单独开一个章节来细说）  “端口转发”有时候也称为“端口映射”，洋文称为“port forwarding”。提及该术语，一般都是指 TCP 协议，有时候也称之为“TCP forward”或“TCP redirection”。  用来搞端口转发的工具有很多，如果你去 Google 一下相关术语，应该能找到一大堆软件或解决方案。考虑到很多读者是菜鸟，俺挑选两种最简单的办法。        ◇利用 Windows 自带的 netsh 
  
   准备工作
    对于 Vista 以及更新版本的 Windows （比如 Win7 Win8 ...）可以直接使用该方案。  对于 Vista 【之前】的 Windows（比如 WinXP、Win2003），需要先安装【IPv6 协议栈】，具体步骤如下：  1. 以管理员身份登录，进入“控制面板”下面的“网络连接”  2. 选中本地连接，点右键，在右键菜单选“属性”  3. 弹出“属性”对话框，点“安装”按钮  4. 弹出“选择网络组件类型”对话框，选“协议”，再点“添加”按钮  5. 在弹出的对话框中选“IPv6”，点“确定”就 OK 啦   
   命令详解
    （以下命令需要管理员身份才能执行）  添加端口转发的命令      netsh interface portproxy add v4tov4 listenport=新开的监听端口 listenaddress=新开端口的绑定地址 connectaddress=要转发的地址 connectport=要转发的端口 protocol=tcp    
  删除端口转发的命令      netsh interface portproxy delete v4tov4 listenport=新开的监听端口 listenaddress=新开端口的绑定地址    
  
   命令举例
    比方说，俺本地已经运行了 Tor，端口是 
   8118
   ，绑定在 
   127.0.0.1
    如果俺希望建立一个新的端口，端口号是 
   12345
   （这个端口号是俺随手编的，你也可以用其它端口号），绑定在 
   0.0.0.0
   上，那么就执行如下命令。然后，发往 
   12345
   端口的数据流就会被转发到 
   8118
   端口。      netsh interface portproxy add v4tov4 listenport=12345 listenaddress=0.0.0.0 connectaddress=127.0.0.1 connectport=8118 protocol=tcp    
  为了保险起见，再用前面介绍的 netstat 命令，看一下本机开启的端口。如果正常的话，你就可以看到如下一行输出      TCP  0.0.0.0:12345  0.0.0.0:0  LISTENING    
  如果要删除该端口转发，就执行如下命令      netsh interface portproxy delete v4tov4 listenport=12345 listenaddress=0.0.0.0    
 删除之后，再用 
   netstat
   命令查一下，这个 
   12345
   的监听端口就看不到了   
   优点
    1. 无需安装任何第三方软件  2. 一旦设置好就会持续有效——即使系统重新启动也没关系。   
   缺点
    1. 需要以管理员身份登录，才能执行上述命令。  2. 该方法只能用于 Windows 系统。        ◇利用 rinetd 
  
   获取软件
    rinetd 是一个很小巧的、跨平台的、开源的工具，它能提供 TCP 端口转发的功能。它的官网在“  这里  ”，上面提供了 Linux 平台和 Windows 平台的软件包。考虑到大多数同学用的是 Windows，俺针对 Windows 的使用介绍一下。  把那个 
   rinetd.zip
   下载到本地，解压出来，里面有好几个文件（包括源代码）。你只需取出其中的 
   rinetd.exe
   其它文件【不】需要。   
   编写配置文件
    rinetd 的配置文件很简单，就是一个普通的文本文件，每一行对应一条转发规则。每一条转发规则包含4个字段，分别如下，字段之间用 
   空格
   分开。      绑定地址 监听端口 转发的地址 转发的端口    
  
   配置文件举例
    举个例子：俺本地已经运行了 Tor，监听端口是 
   9150
   ，绑定在 
   127.0.0.1
    如果俺希望通过 rinetd 建立一个新的端口，端口号是 
   12345
   （这个端口号是俺随手编的，你也可以用其它端口号），绑定在 
   0.0.0.0
   上，那么，转发规则就这么写：      0.0.0.0 12345 127.0.0.1 9150    
  
   运行
    1. 把刚才写好的配置文件保存成 
   config.txt
   （俺只是举例，你也可以用其它文件名），把该文件跟 
   rinetd.exe
   放到【同一个目录】。  2. 运行 
   cmd
   进入 Windows 的命令行窗口（黑窗口）  3. 使用 
   cd
   命令切换当前目录，使得“当前目录”是 
   rinetd.exe
   所在的目录（不会用 
   cd
   命令的同学，请自行 Google 之）  4. 然后执行如下命令      rinetd.exe -c config.txt    
  
   上述命令执行之后，命令行窗口的光标会停止不动。不要以为 rinetd 死了，其实它已经开始工作。【这时候千万不要关闭这个 cmd 窗口】
   。为了保险起见，另外开一个 cmd 窗口，再用前面介绍的 
   netstat
   命令，看一下本机开启的端口。如果正常的话，你就可以看到如下一行输出      TCP  0.0.0.0:12345  0.0.0.0:0  LISTENING    
  
   优点
    1. 该软件很小巧（整个下载包才 100 多 KB），而且是绿色软件。几乎不占用啥系统资源  2. 无需管理员即可运行  3. 跨平台   
   缺点
    1. 每次你关机或用户注销，rinetd 就退出了，下次要用还得重新运行（为了方便，你可以把 rinetd 的启动命令加入 Windows 的启动项）         ★如何共享【VPN 类】的翻墙工具？ 
       ◇问题 
  用 VPN 翻墙，虽然可以让本机的所有网络软件自动通过 VPN 服务器中转。但是其它电脑的软件无法使用本机的 VPN 网络。        ◇解决方案之“Privoxy” 
  “VPN 翻墙”跟“代理翻墙”的技术原理不同——VPN 软件本身是不开启监听端口的。所以刚才介绍的端口转发，对于 VPN 软件是无效滴！  不过没关系，咱们可以在本机运行 Web 代理或 SOCKS 代理，把监听端口绑定到 
   0.0.0.0
   ，就可以让其它电脑的软件通过本机的 VPN 翻墙。考虑到大部分人翻墙都是为了浏览网页，俺重点介绍一下 Privoxy 这个工具。   
   获取软件
    Privoxy 是一个老牌的、跨平台的，开源的 Web 代理软件，官网在“  这里  ”。  在官网上有 exe 安装包，也有 zip 的压缩包（免安装）。下载哪个看你自己的喜好（俺喜欢免安装的，比较绿色）。   
   修改配置文件
    Privoxy 默认的监听端口是8118，绑定在 
   127.0.0.1
   上。为了让其它电脑能连上来，需要修改绑定的地址。  Privoxy 的配置文件是 
   config.txt
   。打开它，搜索 
   listen-address
   会看到如下一行：      listen-address  127.0.0.1:8118    
 然后修改为如下，既可。      listen-address  0.0.0.0:8118    
  
   运行
    直接双击 
   privoxy.exe
    为了保险起见，再用前面介绍的 
   netstat
   命令，看一下本机开启的端口。如果正常的话，你就可以看到如下这行输出：      TCP  0.0.0.0:8118  0.0.0.0:0  LISTENING    
  引申阅读：  Privoxy 是一款功能很强大的工具。为了帮大伙儿更好地利用它，俺后来又专门发了一篇《  如何用 Privoxy 辅助翻墙？  》，有兴趣的同学可以去看一下。         ★如何共享【虚拟机中】的翻墙软件 
  （还不了解虚拟机的同学，可以先看俺写的《  扫盲操作系统虚拟机  》系列教程）  有些网友（包括俺）会单独开一个虚拟机（Guest OS），专门用来安装翻墙工具。在这个虚拟机上，除了翻墙工具，不放其它任何东西。这样做的好处之一是：即使某些翻墙工具有后门，也不会威胁到真实系统（Host OS）的安全。  那么，如何把虚拟机中的翻墙工具共享给其它电脑（Host OS 之外的系统）用捏？        ◇步骤1 
  首先，你还是需要参照前面介绍的方法：  如果用代理翻墙，就搞端口转发；  如果用 VPN 翻墙，就新开一个 Web 代理。        ◇步骤2 
  配置虚拟机的网卡模式，可以有两种搞法。   
   对于 NAT 模式的网卡
    你需要添加端口映射。主流的虚拟机软件（包括 VMware 和 VirtualBox）都有此功能。  该功能类似于刚才提到的【端口转发】，其原理是：把 Host OS 上的某个端口映射到某个虚拟机的 NAT 网卡上的另一个端口。  该方法配置稍嫌麻烦。如果你对网络和虚拟机不太熟悉，俺不推荐用这种搞法，还是改用 Bridge 模式比较省事儿。   
   对于 Bridge 模式的网卡
    如果网卡是 Bridge 模式，那就简单啦—— 
   无需任何额外设置
   。  因为这种模式的虚拟网卡，对于 Host OS 之外的网络是可见的。也就是说，（Host OS 之外的）其它电脑可以直接访问到此网卡——因此其它电脑的软件就能直接连上虚拟机中的代理端口。        ◇引申阅读 
  上述这个招数采用的是【代理/proxy】的方式共享翻墙通道。这个招数有一个前提，就是你的上网软件要有“代理功能”（也就是——能通过软件的“界面”或“配置文件”设置代理）。  万一你使用的网络软件【没有】“代理功能”，咋办捏？请看下面这篇教程：  《  如何让【不支持】代理的网络软件，通过代理进行联网（不同平台的 N 种方法）  》         ★结尾 
  暂且写到这里。如果列位看官针对此话题有啥疑问，或者在实践过程中碰到啥困难，可以到俺博客留言。俺（有空的话）会尽量解答；有些热心读者也会帮忙解答。    
   俺博客上，和本文相关的帖子（需翻墙）
   ：  《  如何翻墙  》（传说中的扫盲教程，定期更新）  《  获取翻墙软件方法大全  》（教你在无法翻墙的情况下拿到翻墙软件）  《  如何让【不支持】代理的网络软件，通过代理进行联网（不同平台的 N 种方法）  》  《  如何用 Privoxy 辅助翻墙？  》  《  扫盲 Linux＆UNIX 命令行——从“电传打字机”聊到“shell 脚本编程”  》  《  扫盲 netcat（网猫）的 N 种用法——从“网络诊断”到“系统入侵”  》     

    版权声明
     本博客所有的原创文章，作者皆保留版权。转载必须包含本声明，保持本文完整，并以超链接形式注明作者  编程随想  和本文原始地址：   https://program-think.blogspot.com/2013/01/cross-host-use-gfw-tool.html 
    
    
  
  
    
         
    
    
    
 
    
  

" />
    <meta property="og:description" content="

      多台电脑如何【共享】翻墙通道——兼谈【端口转发】的几种方法  
  
    
      
    
  
  
     ★引子 
  元旦前后，俺写了《  如何隐藏你的踪迹，避免跨省追捕  》系列的第6、7篇——《用虚拟机隐匿公网IP》。之后有不少网友到博客留言，询问如何让不同虚拟机的软件共享翻墙代理。  所以，俺今天就来聊一聊“多台电脑共享翻墙通道”这个话题。今天介绍的招数，既可以在不同虚拟机之间共享翻墙通道，也可以在不同的实体机（包括PC、平板、手机）之间共享翻墙通道。  
       
        ★预备知识 ＆ 准备工作 
  考虑到俺博客的读者，有很多人【不是】IT 技术人员。所以，俺先通俗地扫盲若干基础知识。        ◇啥是“翻墙”？ 
  如果你对“翻墙”还不太了解，建议你先看看俺写的《  如何翻墙  》一文。这篇扫盲教程可以说是面面俱到，很适合翻墙方面的新手入门。        ◇啥是“代理”？ 
  “代理”好比是一个中转站，可以中转你的上网数据流量，以此来避开 GFW 这堵墙。  翻墙代理通常包括两部分：代理软件，代理服务器。代理软件安装在你的电脑上，代理服务器通常都位于墙外（也就是境外）。当你通过代理上网时，你的浏览器并不是直接连到目标网站。而是通过如下几个步骤：  1. 浏览器发送数据到代理软件  2. 代理软件把你的数据发送到墙外的代理服务器  3. 代理服务器发送数据到目标网站        ◇啥是“监听端口”？ 
  代理软件要正常工作，通常都需要开启一个“监听端口”。浏览器通过这个“监听端口”来跟代理软件建立连接。只有建立了连接，浏览器才能把数据发送到代理软件上。端口号是一个数字，范围在 
   1
   至 
   65535
   之间。        ◇如何看本机开启的监听端口？ 
  对于 Windows 系统，在命令行窗口（先运行 cmd 就会出现命令行窗口）运行如下命令，可以看到本机开启的【所有】监听端口。      netstat -an | find "LISTEN"    
  刚才有读者在留言中提问，俺再补充一下。用 
   netstat
   的 
   o
   选项可以看到每个监听端口分别是【哪个进程】开启滴。命令如下      netstat -ano | find "LISTEN"    
  对于 POSIX 系统（Linux ＆ UNIX），把上述命令中的 
   find
   改为 
   grep
   ，具体如下：      netstat -an | grep "LISTEN"    
       ◇什么是监听端口的“绑定地址”？ 
  以俺手头的虚拟机为例，执行刚才那个命令后，会显示如下输出      TCP  127.0.0.1:8118  0.0.0.0:0  LISTENING    
  其中的 
   127.0.0.1
   表示这个监听端口绑定的网卡地址，而 
   8118
   表示监听的端口号。所谓的“绑定地址”，意思就是说，这个监听端口只接受来自该网卡的连接。  因为 
   127.0.0.1
   表示本机网卡地址；所以，绑定在 
   127.0.0.1
   表示该监听端口只接受来自本机的连接。  如果要让某个监听端口接受任意连接（包括外部电脑的连接），把绑定地址设置为 
   0.0.0.0
   即可。        ◇小心防火墙的配置 
  在《  用虚拟机隐匿公网IP  》一文，俺就特别用红字，提醒大伙儿要小心防火墙的设置。结果还是有很多人因为防火墙的问题而中招，功亏一篑。  俺再啰嗦一下：  要特别小心操作系统中防火墙的设置  。很多人是因为防火墙没设好，导致代理无法连通。  如果你使用本文介绍的招数，却总是搞不定，可以参考下面的教程，用 netcat 诊断一下。  《  扫盲 netcat（网猫）的 N 种用法——从“网络诊断”到“系统入侵”  》         ★如何共享【代理类】的翻墙工具？ 
       ◇问题 
  大部分翻墙代理都会提供一个 TCP 的代理端口（就是刚才说的“监听端口”）。问题在于：很多翻墙代理的代理端口都绑定在 
   127.0.0.1
   上。也就是说，这个代理只能被本机的软件使用，外部电脑的软件无法连接到该端口。        ◇解决方案之“修改配置” 
  最简单的解决方案，就是修改翻墙软件的配置，让代理端口绑定到 
   0.0.0.0
   上。   
   自由门
    到它的设置界面，点“更多设置”，然后勾选“用自由门做服务器”，可以把监听端口绑定到 
   0.0.0.0
     
   GoAgent
    GoAgent 的配置信息存储在 
   proxy.ini
   文件中。打开该文件找到 
   [listen]
   字段，然后把该字段下面的 
   127.0.0.1
   改为 
   0.0.0.0
   即可。   可惜的是，很多翻墙软件都没有提供配置文件让你修改监听端口绑定的地址。所以，俺下面传授一个通用的招数，【无需】修改配置文件，可以【 
   搞定任何翻墙代理
   】，让它的监听端口被外部电脑使用。        ◇解决方案之“端口转发” 
  所谓的“端口转发”，通俗地说就是让 A 监听端口的数据转发到 B 监听端口。  B 监听端口就是你的翻墙软件原先开启的端口  A 监听端口是新开的，而且绑定地址是 
   0.0.0.0
    如此一来，外部电脑就可以用 A 端口作为代理的端口，数据都发给 A 端口，然后利用“端口转发”功能，把数据转向 B 端口（也就是翻墙工具自身的端口）         ★如何搞【端口转发】？ 
  （这招是本文的重点，单独开一个章节来细说）  “端口转发”有时候也称为“端口映射”，洋文称为“port forwarding”。提及该术语，一般都是指 TCP 协议，有时候也称之为“TCP forward”或“TCP redirection”。  用来搞端口转发的工具有很多，如果你去 Google 一下相关术语，应该能找到一大堆软件或解决方案。考虑到很多读者是菜鸟，俺挑选两种最简单的办法。        ◇利用 Windows 自带的 netsh 
  
   准备工作
    对于 Vista 以及更新版本的 Windows （比如 Win7 Win8 ...）可以直接使用该方案。  对于 Vista 【之前】的 Windows（比如 WinXP、Win2003），需要先安装【IPv6 协议栈】，具体步骤如下：  1. 以管理员身份登录，进入“控制面板”下面的“网络连接”  2. 选中本地连接，点右键，在右键菜单选“属性”  3. 弹出“属性”对话框，点“安装”按钮  4. 弹出“选择网络组件类型”对话框，选“协议”，再点“添加”按钮  5. 在弹出的对话框中选“IPv6”，点“确定”就 OK 啦   
   命令详解
    （以下命令需要管理员身份才能执行）  添加端口转发的命令      netsh interface portproxy add v4tov4 listenport=新开的监听端口 listenaddress=新开端口的绑定地址 connectaddress=要转发的地址 connectport=要转发的端口 protocol=tcp    
  删除端口转发的命令      netsh interface portproxy delete v4tov4 listenport=新开的监听端口 listenaddress=新开端口的绑定地址    
  
   命令举例
    比方说，俺本地已经运行了 Tor，端口是 
   8118
   ，绑定在 
   127.0.0.1
    如果俺希望建立一个新的端口，端口号是 
   12345
   （这个端口号是俺随手编的，你也可以用其它端口号），绑定在 
   0.0.0.0
   上，那么就执行如下命令。然后，发往 
   12345
   端口的数据流就会被转发到 
   8118
   端口。      netsh interface portproxy add v4tov4 listenport=12345 listenaddress=0.0.0.0 connectaddress=127.0.0.1 connectport=8118 protocol=tcp    
  为了保险起见，再用前面介绍的 netstat 命令，看一下本机开启的端口。如果正常的话，你就可以看到如下一行输出      TCP  0.0.0.0:12345  0.0.0.0:0  LISTENING    
  如果要删除该端口转发，就执行如下命令      netsh interface portproxy delete v4tov4 listenport=12345 listenaddress=0.0.0.0    
 删除之后，再用 
   netstat
   命令查一下，这个 
   12345
   的监听端口就看不到了   
   优点
    1. 无需安装任何第三方软件  2. 一旦设置好就会持续有效——即使系统重新启动也没关系。   
   缺点
    1. 需要以管理员身份登录，才能执行上述命令。  2. 该方法只能用于 Windows 系统。        ◇利用 rinetd 
  
   获取软件
    rinetd 是一个很小巧的、跨平台的、开源的工具，它能提供 TCP 端口转发的功能。它的官网在“  这里  ”，上面提供了 Linux 平台和 Windows 平台的软件包。考虑到大多数同学用的是 Windows，俺针对 Windows 的使用介绍一下。  把那个 
   rinetd.zip
   下载到本地，解压出来，里面有好几个文件（包括源代码）。你只需取出其中的 
   rinetd.exe
   其它文件【不】需要。   
   编写配置文件
    rinetd 的配置文件很简单，就是一个普通的文本文件，每一行对应一条转发规则。每一条转发规则包含4个字段，分别如下，字段之间用 
   空格
   分开。      绑定地址 监听端口 转发的地址 转发的端口    
  
   配置文件举例
    举个例子：俺本地已经运行了 Tor，监听端口是 
   9150
   ，绑定在 
   127.0.0.1
    如果俺希望通过 rinetd 建立一个新的端口，端口号是 
   12345
   （这个端口号是俺随手编的，你也可以用其它端口号），绑定在 
   0.0.0.0
   上，那么，转发规则就这么写：      0.0.0.0 12345 127.0.0.1 9150    
  
   运行
    1. 把刚才写好的配置文件保存成 
   config.txt
   （俺只是举例，你也可以用其它文件名），把该文件跟 
   rinetd.exe
   放到【同一个目录】。  2. 运行 
   cmd
   进入 Windows 的命令行窗口（黑窗口）  3. 使用 
   cd
   命令切换当前目录，使得“当前目录”是 
   rinetd.exe
   所在的目录（不会用 
   cd
   命令的同学，请自行 Google 之）  4. 然后执行如下命令      rinetd.exe -c config.txt    
  
   上述命令执行之后，命令行窗口的光标会停止不动。不要以为 rinetd 死了，其实它已经开始工作。【这时候千万不要关闭这个 cmd 窗口】
   。为了保险起见，另外开一个 cmd 窗口，再用前面介绍的 
   netstat
   命令，看一下本机开启的端口。如果正常的话，你就可以看到如下一行输出      TCP  0.0.0.0:12345  0.0.0.0:0  LISTENING    
  
   优点
    1. 该软件很小巧（整个下载包才 100 多 KB），而且是绿色软件。几乎不占用啥系统资源  2. 无需管理员即可运行  3. 跨平台   
   缺点
    1. 每次你关机或用户注销，rinetd 就退出了，下次要用还得重新运行（为了方便，你可以把 rinetd 的启动命令加入 Windows 的启动项）         ★如何共享【VPN 类】的翻墙工具？ 
       ◇问题 
  用 VPN 翻墙，虽然可以让本机的所有网络软件自动通过 VPN 服务器中转。但是其它电脑的软件无法使用本机的 VPN 网络。        ◇解决方案之“Privoxy” 
  “VPN 翻墙”跟“代理翻墙”的技术原理不同——VPN 软件本身是不开启监听端口的。所以刚才介绍的端口转发，对于 VPN 软件是无效滴！  不过没关系，咱们可以在本机运行 Web 代理或 SOCKS 代理，把监听端口绑定到 
   0.0.0.0
   ，就可以让其它电脑的软件通过本机的 VPN 翻墙。考虑到大部分人翻墙都是为了浏览网页，俺重点介绍一下 Privoxy 这个工具。   
   获取软件
    Privoxy 是一个老牌的、跨平台的，开源的 Web 代理软件，官网在“  这里  ”。  在官网上有 exe 安装包，也有 zip 的压缩包（免安装）。下载哪个看你自己的喜好（俺喜欢免安装的，比较绿色）。   
   修改配置文件
    Privoxy 默认的监听端口是8118，绑定在 
   127.0.0.1
   上。为了让其它电脑能连上来，需要修改绑定的地址。  Privoxy 的配置文件是 
   config.txt
   。打开它，搜索 
   listen-address
   会看到如下一行：      listen-address  127.0.0.1:8118    
 然后修改为如下，既可。      listen-address  0.0.0.0:8118    
  
   运行
    直接双击 
   privoxy.exe
    为了保险起见，再用前面介绍的 
   netstat
   命令，看一下本机开启的端口。如果正常的话，你就可以看到如下这行输出：      TCP  0.0.0.0:8118  0.0.0.0:0  LISTENING    
  引申阅读：  Privoxy 是一款功能很强大的工具。为了帮大伙儿更好地利用它，俺后来又专门发了一篇《  如何用 Privoxy 辅助翻墙？  》，有兴趣的同学可以去看一下。         ★如何共享【虚拟机中】的翻墙软件 
  （还不了解虚拟机的同学，可以先看俺写的《  扫盲操作系统虚拟机  》系列教程）  有些网友（包括俺）会单独开一个虚拟机（Guest OS），专门用来安装翻墙工具。在这个虚拟机上，除了翻墙工具，不放其它任何东西。这样做的好处之一是：即使某些翻墙工具有后门，也不会威胁到真实系统（Host OS）的安全。  那么，如何把虚拟机中的翻墙工具共享给其它电脑（Host OS 之外的系统）用捏？        ◇步骤1 
  首先，你还是需要参照前面介绍的方法：  如果用代理翻墙，就搞端口转发；  如果用 VPN 翻墙，就新开一个 Web 代理。        ◇步骤2 
  配置虚拟机的网卡模式，可以有两种搞法。   
   对于 NAT 模式的网卡
    你需要添加端口映射。主流的虚拟机软件（包括 VMware 和 VirtualBox）都有此功能。  该功能类似于刚才提到的【端口转发】，其原理是：把 Host OS 上的某个端口映射到某个虚拟机的 NAT 网卡上的另一个端口。  该方法配置稍嫌麻烦。如果你对网络和虚拟机不太熟悉，俺不推荐用这种搞法，还是改用 Bridge 模式比较省事儿。   
   对于 Bridge 模式的网卡
    如果网卡是 Bridge 模式，那就简单啦—— 
   无需任何额外设置
   。  因为这种模式的虚拟网卡，对于 Host OS 之外的网络是可见的。也就是说，（Host OS 之外的）其它电脑可以直接访问到此网卡——因此其它电脑的软件就能直接连上虚拟机中的代理端口。        ◇引申阅读 
  上述这个招数采用的是【代理/proxy】的方式共享翻墙通道。这个招数有一个前提，就是你的上网软件要有“代理功能”（也就是——能通过软件的“界面”或“配置文件”设置代理）。  万一你使用的网络软件【没有】“代理功能”，咋办捏？请看下面这篇教程：  《  如何让【不支持】代理的网络软件，通过代理进行联网（不同平台的 N 种方法）  》         ★结尾 
  暂且写到这里。如果列位看官针对此话题有啥疑问，或者在实践过程中碰到啥困难，可以到俺博客留言。俺（有空的话）会尽量解答；有些热心读者也会帮忙解答。    
   俺博客上，和本文相关的帖子（需翻墙）
   ：  《  如何翻墙  》（传说中的扫盲教程，定期更新）  《  获取翻墙软件方法大全  》（教你在无法翻墙的情况下拿到翻墙软件）  《  如何让【不支持】代理的网络软件，通过代理进行联网（不同平台的 N 种方法）  》  《  如何用 Privoxy 辅助翻墙？  》  《  扫盲 Linux＆UNIX 命令行——从“电传打字机”聊到“shell 脚本编程”  》  《  扫盲 netcat（网猫）的 N 种用法——从“网络诊断”到“系统入侵”  》     

    版权声明
     本博客所有的原创文章，作者皆保留版权。转载必须包含本声明，保持本文完整，并以超链接形式注明作者  编程随想  和本文原始地址：   https://program-think.blogspot.com/2013/01/cross-host-use-gfw-tool.html 
    
    
  
  
    
         
    
    
    
 
    
  

" />
    
    <meta name="author" content="觀點" />

    
    <meta property="og:title" content="多台电脑如何【共享】翻墙通道——兼谈【端口转发】的几种方法" />
    <meta property="twitter:title" content="多台电脑如何【共享】翻墙通道——兼谈【端口转发】的几种方法" />
    

  <link rel="stylesheet" type="text/css" href="/opinion/style.css" />
  <link rel="alternate" type="application/rss+xml" title="觀點 - 從草根到大師 git.io/JJCxS" href="/opinion/feed.xml" />

  <!-- Social Share Kit CSS -->
  <link rel="stylesheet" href="/opinion/assets/css/social-share-kit.css" type="text/css">
  <link rel="stylesheet" href="/opinion/assets/css/font-awesome.min.css" type="text/css">
  <link rel="stylesheet" href="/opinion/assets/css/bootstrap.min.css" type="text/css">
  <script type="text/javascript" src="/opinion/assets/js/jquery-3.5.1.js"></script>
  <script type="text/javascript" src="/opinion/assets/js/page.js"></script>

</head>

  <body>
    <div class="wrapper-masthead">
  <div class="container">
    <header class="masthead clearfix">
      

      <div class="site-info">
        <h1 class="site-name" style="display: inline-block;"><a href="/opinion/">觀點</a></h1>
        <i class="site-description" style="font-size: 12px;">從草根到大師 git.io/JJCxS</i>
      </div>

      <nav>
        <span id="search-container" >
          <a href="/opinion/tools"><i class="fa fa-bookmark twitter" title="百宝箱"></i></a>
        <a><i class="fa fa-search" title="限前100結果"></i></a><input type="text" id="search-input" placeholder="標題 作者 來源 日期 (17499)"
          style="margin: 10px 0px 0px 0px; height: 30px;width: auto" title="本站最正確的打開方式">
        </span>
        
        
        <a href="/opinion/categories" style="color: Tomato;"><i class="fa fa-tags" title="分类"></i></a>
        
        
        
        <a href="https://be4.herokuapp.com/" style="color: #003366;"><i class="fa fa-comments" title="论坛"></i></a>
        
        
        
        <a href="/opinion/about"><i class="fa fa-info-circle" title="关于"></i></a>
        
        
        <a title="电脑热键：&larr;上一篇(页), &rarr;下一篇(页), ins同来源新一篇，del同来源旧一篇" onclick="toggle_visibility('help')"><i class="fa fa-question-circle"></i></a>
        <a id="fa-home" href="https://nodebe4.github.io" title="BE4服务列表" onclick="//toggle_visibility('site-list')"><i class="fa fa-home" aria-hidden="true"></i></a>
      </nav>

    </header>
    <div id="site-list" class="tags" style="display: block;text-align: right;border-bottom: 1px solid lightGray;"><noscript><span style="background-color: #e8e8e8;color: #d10000;font-size: 14px;">开启浏览器JavaScript以获取搜索功能和更好的浏览体验</span></noscript></div>
    <p id="help" style="font-size: 14px;display: none;text-align: right;"><span style="color:green;">电脑热键：&larr;上一篇(页), &rarr;下一篇(页), ins同来源新一篇, del同来源旧一篇</span>; <span style="color:orange">对应触屏FAB：上下右左</span>; 轉Markdown<a href="https://euangoddard.github.io/clipboard2markdown/"><i class="fa fa-file-text-o"></i></a></p>
  </div>
</div>

<script type="text/javascript" >
  function toggle_visibility(id){
    var help = document.getElementById(id)
    if (help.style.display=='none'){
      help.style.display='block';
    }else{
      help.style.display='none';
    }
  }

  const url = "https://nodebe4.github.io/sitelist.json"

  document.addEventListener("DOMContentLoaded", function(event){
    // var homebtn = document.getElementById("fa-home")
    // homebtn.removeAttribute("href")
    var content = document.getElementById("site-list");
    content.innerHTML = ''
    var ul = document.createElement("ul")
    ul.classList.add("label")
    content.appendChild(ul)
    var cnt = 0

    $.getJSON(url, function(allsites) {

      allsites.map(item =>{
        var li = document.createElement('li')
        li.classList.add("tag")
        li.id = 'site-' + cnt
        ul.appendChild(li)
        var a0 = document.createElement('a')
        li.appendChild(a0)
        a0.href = item.url[0]
        var span = document.createElement('span')
        a0.appendChild(span)
        span.innerText = item['name']
        // span.style.backgroundColor = item['background-color']
        // span.style.color='#E4CBC3'
        span.style.color = item['background-color']
        span.style['font-size'] = '14px'
        cnt += 1
        // test_alive(li.id, a0.href)
      })
    })
  })

function test_alive(id, url){
  var divstatus = document.getElementById(id)
  const base = 'https://textance.herokuapp.com/title/'
  var fullurl = base + url
  $.ajax({
      url: fullurl,
      complete: function(data) {
        if (data.responseText.includes('502')){
          // divstatus.style.color='#FBB7B7'
          // divstatus.style.color='gray'
          // divstatus.title = "服务器无响应"
          divstatus.parentNode.removeChild(divstatus)
        }else{
          // divstatus.style.color='#B6FAC8'
          divstatus.title = data.responseText
        }
      }
  });
  return divstatus
}
</script>



    <!-- Left & centered positioning -->

<div class="ssk-sticky ssk-right ssk-center ssk-sticky-hide-xs ssk-group ssk-round">
  
    <a href="https://be4news.pythonanywhere.com/archivenow/ia/https%3A%2F%2Fprogram-think.blogspot.com%2F2013%2F01%2Fcross-host-use-gfw-tool.html" class="ssk ssk-link" title="存到互联网档案馆" target="_blank"></a>
    <a href="https://www.facebook.com/sharer.php?u=https://program-think.blogspot.com/2013/01/cross-host-use-gfw-tool.html" class="ssk ssk-facebook"></a>
    <a href="https://twitter.com/intent/tweet?url=https://program-think.blogspot.com/2013/01/cross-host-use-gfw-tool.html&text=多台电脑如何【共享】翻墙通道——兼谈【端口转发】的几种方法&hashtags=觀點" class="ssk ssk-twitter"></a>
    <a href="https://reddit.com/submit?url=https://program-think.blogspot.com/2013/01/cross-host-use-gfw-tool.html&title=多台电脑如何【共享】翻墙通道——兼谈【端口转发】的几种方法" class="ssk ssk-reddit"></a>
    <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://program-think.blogspot.com/2013/01/cross-host-use-gfw-tool.html&title=多台电脑如何【共享】翻墙通道——兼谈【端口转发】的几种方法" class="ssk ssk-linkedin"></a>
    <a href="mailto:{email_address}?subject=多台电脑如何【共享】翻墙通道——兼谈【端口转发】的几种方法&body=

      多台电脑如何【共享】翻墙通道——兼谈【端口转发】的几种方法  
  
    
      
    
  
  
     ★引子 
  元旦前后，俺写了《  如何隐藏你的踪迹，避免跨省追捕  》系列的第6、7篇——《用虚拟机隐匿公网IP》。之后有不少网友到博客留言，询问如何让不同虚拟机的软件共享翻墙代理。  所以，俺今天就来聊一聊“多台电脑共享翻墙通道”这个话题。今天介绍的招数，既可以在不同虚拟机之间共享翻墙通道，也可以在不同的实体机（包括PC、平板、手机）之间共享翻墙通道。  
       
        ★预备知识 ＆ 准备工作 
  考虑到俺博客的读者，有很多人【不是】IT 技术人员。所以，俺先通俗地扫盲若干基础知识。        ◇啥是“翻墙”？ 
  如果你对“翻墙”还不太了解，建议你先看看俺写的《  如何翻墙  》一文。这篇扫盲教程可以说是面面俱到，很适合翻墙方面的新手入门。        ◇啥是“代理”？ 
  “代理”好比是一个中转站，可以中转你的上网数据流量，以此来避开 GFW 这堵墙。  翻墙代理通常包括两部分：代理软件，代理服务器。代理软件安装在你的电脑上，代理服务器通常都位于墙外（也就是境外）。当你通过代理上网时，你的浏览器并不是直接连到目标网站。而是通过如下几个步骤：  1. 浏览器发送数据到代理软件  2. 代理软件把你的数据发送到墙外的代理服务器  3. 代理服务器发送数据到目标网站        ◇啥是“监听端口”？ 
  代理软件要正常工作，通常都需要开启一个“监听端口”。浏览器通过这个“监听端口”来跟代理软件建立连接。只有建立了连接，浏览器才能把数据发送到代理软件上。端口号是一个数字，范围在 
   1
   至 
   65535
   之间。        ◇如何看本机开启的监听端口？ 
  对于 Windows 系统，在命令行窗口（先运行 cmd 就会出现命令行窗口）运行如下命令，可以看到本机开启的【所有】监听端口。      netstat -an | find "LISTEN"    
  刚才有读者在留言中提问，俺再补充一下。用 
   netstat
   的 
   o
   选项可以看到每个监听端口分别是【哪个进程】开启滴。命令如下      netstat -ano | find "LISTEN"    
  对于 POSIX 系统（Linux ＆ UNIX），把上述命令中的 
   find
   改为 
   grep
   ，具体如下：      netstat -an | grep "LISTEN"    
       ◇什么是监听端口的“绑定地址”？ 
  以俺手头的虚拟机为例，执行刚才那个命令后，会显示如下输出      TCP  127.0.0.1:8118  0.0.0.0:0  LISTENING    
  其中的 
   127.0.0.1
   表示这个监听端口绑定的网卡地址，而 
   8118
   表示监听的端口号。所谓的“绑定地址”，意思就是说，这个监听端口只接受来自该网卡的连接。  因为 
   127.0.0.1
   表示本机网卡地址；所以，绑定在 
   127.0.0.1
   表示该监听端口只接受来自本机的连接。  如果要让某个监听端口接受任意连接（包括外部电脑的连接），把绑定地址设置为 
   0.0.0.0
   即可。        ◇小心防火墙的配置 
  在《  用虚拟机隐匿公网IP  》一文，俺就特别用红字，提醒大伙儿要小心防火墙的设置。结果还是有很多人因为防火墙的问题而中招，功亏一篑。  俺再啰嗦一下：  要特别小心操作系统中防火墙的设置  。很多人是因为防火墙没设好，导致代理无法连通。  如果你使用本文介绍的招数，却总是搞不定，可以参考下面的教程，用 netcat 诊断一下。  《  扫盲 netcat（网猫）的 N 种用法——从“网络诊断”到“系统入侵”  》         ★如何共享【代理类】的翻墙工具？ 
       ◇问题 
  大部分翻墙代理都会提供一个 TCP 的代理端口（就是刚才说的“监听端口”）。问题在于：很多翻墙代理的代理端口都绑定在 
   127.0.0.1
   上。也就是说，这个代理只能被本机的软件使用，外部电脑的软件无法连接到该端口。        ◇解决方案之“修改配置” 
  最简单的解决方案，就是修改翻墙软件的配置，让代理端口绑定到 
   0.0.0.0
   上。   
   自由门
    到它的设置界面，点“更多设置”，然后勾选“用自由门做服务器”，可以把监听端口绑定到 
   0.0.0.0
     
   GoAgent
    GoAgent 的配置信息存储在 
   proxy.ini
   文件中。打开该文件找到 
   [listen]
   字段，然后把该字段下面的 
   127.0.0.1
   改为 
   0.0.0.0
   即可。   可惜的是，很多翻墙软件都没有提供配置文件让你修改监听端口绑定的地址。所以，俺下面传授一个通用的招数，【无需】修改配置文件，可以【 
   搞定任何翻墙代理
   】，让它的监听端口被外部电脑使用。        ◇解决方案之“端口转发” 
  所谓的“端口转发”，通俗地说就是让 A 监听端口的数据转发到 B 监听端口。  B 监听端口就是你的翻墙软件原先开启的端口  A 监听端口是新开的，而且绑定地址是 
   0.0.0.0
    如此一来，外部电脑就可以用 A 端口作为代理的端口，数据都发给 A 端口，然后利用“端口转发”功能，把数据转向 B 端口（也就是翻墙工具自身的端口）         ★如何搞【端口转发】？ 
  （这招是本文的重点，单独开一个章节来细说）  “端口转发”有时候也称为“端口映射”，洋文称为“port forwarding”。提及该术语，一般都是指 TCP 协议，有时候也称之为“TCP forward”或“TCP redirection”。  用来搞端口转发的工具有很多，如果你去 Google 一下相关术语，应该能找到一大堆软件或解决方案。考虑到很多读者是菜鸟，俺挑选两种最简单的办法。        ◇利用 Windows 自带的 netsh 
  
   准备工作
    对于 Vista 以及更新版本的 Windows （比如 Win7 Win8 ...）可以直接使用该方案。  对于 Vista 【之前】的 Windows（比如 WinXP、Win2003），需要先安装【IPv6 协议栈】，具体步骤如下：  1. 以管理员身份登录，进入“控制面板”下面的“网络连接”  2. 选中本地连接，点右键，在右键菜单选“属性”  3. 弹出“属性”对话框，点“安装”按钮  4. 弹出“选择网络组件类型”对话框，选“协议”，再点“添加”按钮  5. 在弹出的对话框中选“IPv6”，点“确定”就 OK 啦   
   命令详解
    （以下命令需要管理员身份才能执行）  添加端口转发的命令      netsh interface portproxy add v4tov4 listenport=新开的监听端口 listenaddress=新开端口的绑定地址 connectaddress=要转发的地址 connectport=要转发的端口 protocol=tcp    
  删除端口转发的命令      netsh interface portproxy delete v4tov4 listenport=新开的监听端口 listenaddress=新开端口的绑定地址    
  
   命令举例
    比方说，俺本地已经运行了 Tor，端口是 
   8118
   ，绑定在 
   127.0.0.1
    如果俺希望建立一个新的端口，端口号是 
   12345
   （这个端口号是俺随手编的，你也可以用其它端口号），绑定在 
   0.0.0.0
   上，那么就执行如下命令。然后，发往 
   12345
   端口的数据流就会被转发到 
   8118
   端口。      netsh interface portproxy add v4tov4 listenport=12345 listenaddress=0.0.0.0 connectaddress=127.0.0.1 connectport=8118 protocol=tcp    
  为了保险起见，再用前面介绍的 netstat 命令，看一下本机开启的端口。如果正常的话，你就可以看到如下一行输出      TCP  0.0.0.0:12345  0.0.0.0:0  LISTENING    
  如果要删除该端口转发，就执行如下命令      netsh interface portproxy delete v4tov4 listenport=12345 listenaddress=0.0.0.0    
 删除之后，再用 
   netstat
   命令查一下，这个 
   12345
   的监听端口就看不到了   
   优点
    1. 无需安装任何第三方软件  2. 一旦设置好就会持续有效——即使系统重新启动也没关系。   
   缺点
    1. 需要以管理员身份登录，才能执行上述命令。  2. 该方法只能用于 Windows 系统。        ◇利用 rinetd 
  
   获取软件
    rinetd 是一个很小巧的、跨平台的、开源的工具，它能提供 TCP 端口转发的功能。它的官网在“  这里  ”，上面提供了 Linux 平台和 Windows 平台的软件包。考虑到大多数同学用的是 Windows，俺针对 Windows 的使用介绍一下。  把那个 
   rinetd.zip
   下载到本地，解压出来，里面有好几个文件（包括源代码）。你只需取出其中的 
   rinetd.exe
   其它文件【不】需要。   
   编写配置文件
    rinetd 的配置文件很简单，就是一个普通的文本文件，每一行对应一条转发规则。每一条转发规则包含4个字段，分别如下，字段之间用 
   空格
   分开。      绑定地址 监听端口 转发的地址 转发的端口    
  
   配置文件举例
    举个例子：俺本地已经运行了 Tor，监听端口是 
   9150
   ，绑定在 
   127.0.0.1
    如果俺希望通过 rinetd 建立一个新的端口，端口号是 
   12345
   （这个端口号是俺随手编的，你也可以用其它端口号），绑定在 
   0.0.0.0
   上，那么，转发规则就这么写：      0.0.0.0 12345 127.0.0.1 9150    
  
   运行
    1. 把刚才写好的配置文件保存成 
   config.txt
   （俺只是举例，你也可以用其它文件名），把该文件跟 
   rinetd.exe
   放到【同一个目录】。  2. 运行 
   cmd
   进入 Windows 的命令行窗口（黑窗口）  3. 使用 
   cd
   命令切换当前目录，使得“当前目录”是 
   rinetd.exe
   所在的目录（不会用 
   cd
   命令的同学，请自行 Google 之）  4. 然后执行如下命令      rinetd.exe -c config.txt    
  
   上述命令执行之后，命令行窗口的光标会停止不动。不要以为 rinetd 死了，其实它已经开始工作。【这时候千万不要关闭这个 cmd 窗口】
   。为了保险起见，另外开一个 cmd 窗口，再用前面介绍的 
   netstat
   命令，看一下本机开启的端口。如果正常的话，你就可以看到如下一行输出      TCP  0.0.0.0:12345  0.0.0.0:0  LISTENING    
  
   优点
    1. 该软件很小巧（整个下载包才 100 多 KB），而且是绿色软件。几乎不占用啥系统资源  2. 无需管理员即可运行  3. 跨平台   
   缺点
    1. 每次你关机或用户注销，rinetd 就退出了，下次要用还得重新运行（为了方便，你可以把 rinetd 的启动命令加入 Windows 的启动项）         ★如何共享【VPN 类】的翻墙工具？ 
       ◇问题 
  用 VPN 翻墙，虽然可以让本机的所有网络软件自动通过 VPN 服务器中转。但是其它电脑的软件无法使用本机的 VPN 网络。        ◇解决方案之“Privoxy” 
  “VPN 翻墙”跟“代理翻墙”的技术原理不同——VPN 软件本身是不开启监听端口的。所以刚才介绍的端口转发，对于 VPN 软件是无效滴！  不过没关系，咱们可以在本机运行 Web 代理或 SOCKS 代理，把监听端口绑定到 
   0.0.0.0
   ，就可以让其它电脑的软件通过本机的 VPN 翻墙。考虑到大部分人翻墙都是为了浏览网页，俺重点介绍一下 Privoxy 这个工具。   
   获取软件
    Privoxy 是一个老牌的、跨平台的，开源的 Web 代理软件，官网在“  这里  ”。  在官网上有 exe 安装包，也有 zip 的压缩包（免安装）。下载哪个看你自己的喜好（俺喜欢免安装的，比较绿色）。   
   修改配置文件
    Privoxy 默认的监听端口是8118，绑定在 
   127.0.0.1
   上。为了让其它电脑能连上来，需要修改绑定的地址。  Privoxy 的配置文件是 
   config.txt
   。打开它，搜索 
   listen-address
   会看到如下一行：      listen-address  127.0.0.1:8118    
 然后修改为如下，既可。      listen-address  0.0.0.0:8118    
  
   运行
    直接双击 
   privoxy.exe
    为了保险起见，再用前面介绍的 
   netstat
   命令，看一下本机开启的端口。如果正常的话，你就可以看到如下这行输出：      TCP  0.0.0.0:8118  0.0.0.0:0  LISTENING    
  引申阅读：  Privoxy 是一款功能很强大的工具。为了帮大伙儿更好地利用它，俺后来又专门发了一篇《  如何用 Privoxy 辅助翻墙？  》，有兴趣的同学可以去看一下。         ★如何共享【虚拟机中】的翻墙软件 
  （还不了解虚拟机的同学，可以先看俺写的《  扫盲操作系统虚拟机  》系列教程）  有些网友（包括俺）会单独开一个虚拟机（Guest OS），专门用来安装翻墙工具。在这个虚拟机上，除了翻墙工具，不放其它任何东西。这样做的好处之一是：即使某些翻墙工具有后门，也不会威胁到真实系统（Host OS）的安全。  那么，如何把虚拟机中的翻墙工具共享给其它电脑（Host OS 之外的系统）用捏？        ◇步骤1 
  首先，你还是需要参照前面介绍的方法：  如果用代理翻墙，就搞端口转发；  如果用 VPN 翻墙，就新开一个 Web 代理。        ◇步骤2 
  配置虚拟机的网卡模式，可以有两种搞法。   
   对于 NAT 模式的网卡
    你需要添加端口映射。主流的虚拟机软件（包括 VMware 和 VirtualBox）都有此功能。  该功能类似于刚才提到的【端口转发】，其原理是：把 Host OS 上的某个端口映射到某个虚拟机的 NAT 网卡上的另一个端口。  该方法配置稍嫌麻烦。如果你对网络和虚拟机不太熟悉，俺不推荐用这种搞法，还是改用 Bridge 模式比较省事儿。   
   对于 Bridge 模式的网卡
    如果网卡是 Bridge 模式，那就简单啦—— 
   无需任何额外设置
   。  因为这种模式的虚拟网卡，对于 Host OS 之外的网络是可见的。也就是说，（Host OS 之外的）其它电脑可以直接访问到此网卡——因此其它电脑的软件就能直接连上虚拟机中的代理端口。        ◇引申阅读 
  上述这个招数采用的是【代理/proxy】的方式共享翻墙通道。这个招数有一个前提，就是你的上网软件要有“代理功能”（也就是——能通过软件的“界面”或“配置文件”设置代理）。  万一你使用的网络软件【没有】“代理功能”，咋办捏？请看下面这篇教程：  《  如何让【不支持】代理的网络软件，通过代理进行联网（不同平台的 N 种方法）  》         ★结尾 
  暂且写到这里。如果列位看官针对此话题有啥疑问，或者在实践过程中碰到啥困难，可以到俺博客留言。俺（有空的话）会尽量解答；有些热心读者也会帮忙解答。    
   俺博客上，和本文相关的帖子（需翻墙）
   ：  《  如何翻墙  》（传说中的扫盲教程，定期更新）  《  获取翻墙软件方法大全  》（教你在无法翻墙的情况下拿到翻墙软件）  《  如何让【不支持】代理的网络软件，通过代理进行联网（不同平台的 N 种方法）  》  《  如何用 Privoxy 辅助翻墙？  》  《  扫盲 Linux＆UNIX 命令行——从“电传打字机”聊到“shell 脚本编程”  》  《  扫盲 netcat（网猫）的 N 种用法——从“网络诊断”到“系统入侵”  》     

    版权声明
     本博客所有的原创文章，作者皆保留版权。转载必须包含本声明，保持本文完整，并以超链接形式注明作者  编程随想  和本文原始地址：   https://program-think.blogspot.com/2013/01/cross-host-use-gfw-tool.html 
    
    
  
  
    
         
    
    
    
 
    
  

" class="ssk ssk-email"></a>
    <a href="http://pinterest.com/pin/create/link/?url=https://program-think.blogspot.com/2013/01/cross-host-use-gfw-tool.html" class="ssk ssk-pinterest"></a>
    <a href="https://www.tumblr.com/widgets/share/tool?canonicalUrl=https://program-think.blogspot.com/2013/01/cross-host-use-gfw-tool.html&title=多台电脑如何【共享】翻墙通道——兼谈【端口转发】的几种方法&caption=

      多台电脑如何【共享】翻墙通道——兼谈【端口转发】的几种方法  
  
    
      
    
  
  
     ★引子 
  元旦前后，俺写了《  如何隐藏你的踪迹，避免跨省追捕  》系列的第6、7篇——《用虚拟机隐匿公网IP》。之后有不少网友到博客留言，询问如何让不同虚拟机的软件共享翻墙代理。  所以，俺今天就来聊一聊“多台电脑共享翻墙通道”这个话题。今天介绍的招数，既可以在不同虚拟机之间共享翻墙通道，也可以在不同的实体机（包括PC、平板、手机）之间共享翻墙通道。  
       
        ★预备知识 ＆ 准备工作 
  考虑到俺博客的读者，有很多人【不是】IT 技术人员。所以，俺先通俗地扫盲若干基础知识。        ◇啥是“翻墙”？ 
  如果你对“翻墙”还不太了解，建议你先看看俺写的《  如何翻墙  》一文。这篇扫盲教程可以说是面面俱到，很适合翻墙方面的新手入门。        ◇啥是“代理”？ 
  “代理”好比是一个中转站，可以中转你的上网数据流量，以此来避开 GFW 这堵墙。  翻墙代理通常包括两部分：代理软件，代理服务器。代理软件安装在你的电脑上，代理服务器通常都位于墙外（也就是境外）。当你通过代理上网时，你的浏览器并不是直接连到目标网站。而是通过如下几个步骤：  1. 浏览器发送数据到代理软件  2. 代理软件把你的数据发送到墙外的代理服务器  3. 代理服务器发送数据到目标网站        ◇啥是“监听端口”？ 
  代理软件要正常工作，通常都需要开启一个“监听端口”。浏览器通过这个“监听端口”来跟代理软件建立连接。只有建立了连接，浏览器才能把数据发送到代理软件上。端口号是一个数字，范围在 
   1
   至 
   65535
   之间。        ◇如何看本机开启的监听端口？ 
  对于 Windows 系统，在命令行窗口（先运行 cmd 就会出现命令行窗口）运行如下命令，可以看到本机开启的【所有】监听端口。      netstat -an | find "LISTEN"    
  刚才有读者在留言中提问，俺再补充一下。用 
   netstat
   的 
   o
   选项可以看到每个监听端口分别是【哪个进程】开启滴。命令如下      netstat -ano | find "LISTEN"    
  对于 POSIX 系统（Linux ＆ UNIX），把上述命令中的 
   find
   改为 
   grep
   ，具体如下：      netstat -an | grep "LISTEN"    
       ◇什么是监听端口的“绑定地址”？ 
  以俺手头的虚拟机为例，执行刚才那个命令后，会显示如下输出      TCP  127.0.0.1:8118  0.0.0.0:0  LISTENING    
  其中的 
   127.0.0.1
   表示这个监听端口绑定的网卡地址，而 
   8118
   表示监听的端口号。所谓的“绑定地址”，意思就是说，这个监听端口只接受来自该网卡的连接。  因为 
   127.0.0.1
   表示本机网卡地址；所以，绑定在 
   127.0.0.1
   表示该监听端口只接受来自本机的连接。  如果要让某个监听端口接受任意连接（包括外部电脑的连接），把绑定地址设置为 
   0.0.0.0
   即可。        ◇小心防火墙的配置 
  在《  用虚拟机隐匿公网IP  》一文，俺就特别用红字，提醒大伙儿要小心防火墙的设置。结果还是有很多人因为防火墙的问题而中招，功亏一篑。  俺再啰嗦一下：  要特别小心操作系统中防火墙的设置  。很多人是因为防火墙没设好，导致代理无法连通。  如果你使用本文介绍的招数，却总是搞不定，可以参考下面的教程，用 netcat 诊断一下。  《  扫盲 netcat（网猫）的 N 种用法——从“网络诊断”到“系统入侵”  》         ★如何共享【代理类】的翻墙工具？ 
       ◇问题 
  大部分翻墙代理都会提供一个 TCP 的代理端口（就是刚才说的“监听端口”）。问题在于：很多翻墙代理的代理端口都绑定在 
   127.0.0.1
   上。也就是说，这个代理只能被本机的软件使用，外部电脑的软件无法连接到该端口。        ◇解决方案之“修改配置” 
  最简单的解决方案，就是修改翻墙软件的配置，让代理端口绑定到 
   0.0.0.0
   上。   
   自由门
    到它的设置界面，点“更多设置”，然后勾选“用自由门做服务器”，可以把监听端口绑定到 
   0.0.0.0
     
   GoAgent
    GoAgent 的配置信息存储在 
   proxy.ini
   文件中。打开该文件找到 
   [listen]
   字段，然后把该字段下面的 
   127.0.0.1
   改为 
   0.0.0.0
   即可。   可惜的是，很多翻墙软件都没有提供配置文件让你修改监听端口绑定的地址。所以，俺下面传授一个通用的招数，【无需】修改配置文件，可以【 
   搞定任何翻墙代理
   】，让它的监听端口被外部电脑使用。        ◇解决方案之“端口转发” 
  所谓的“端口转发”，通俗地说就是让 A 监听端口的数据转发到 B 监听端口。  B 监听端口就是你的翻墙软件原先开启的端口  A 监听端口是新开的，而且绑定地址是 
   0.0.0.0
    如此一来，外部电脑就可以用 A 端口作为代理的端口，数据都发给 A 端口，然后利用“端口转发”功能，把数据转向 B 端口（也就是翻墙工具自身的端口）         ★如何搞【端口转发】？ 
  （这招是本文的重点，单独开一个章节来细说）  “端口转发”有时候也称为“端口映射”，洋文称为“port forwarding”。提及该术语，一般都是指 TCP 协议，有时候也称之为“TCP forward”或“TCP redirection”。  用来搞端口转发的工具有很多，如果你去 Google 一下相关术语，应该能找到一大堆软件或解决方案。考虑到很多读者是菜鸟，俺挑选两种最简单的办法。        ◇利用 Windows 自带的 netsh 
  
   准备工作
    对于 Vista 以及更新版本的 Windows （比如 Win7 Win8 ...）可以直接使用该方案。  对于 Vista 【之前】的 Windows（比如 WinXP、Win2003），需要先安装【IPv6 协议栈】，具体步骤如下：  1. 以管理员身份登录，进入“控制面板”下面的“网络连接”  2. 选中本地连接，点右键，在右键菜单选“属性”  3. 弹出“属性”对话框，点“安装”按钮  4. 弹出“选择网络组件类型”对话框，选“协议”，再点“添加”按钮  5. 在弹出的对话框中选“IPv6”，点“确定”就 OK 啦   
   命令详解
    （以下命令需要管理员身份才能执行）  添加端口转发的命令      netsh interface portproxy add v4tov4 listenport=新开的监听端口 listenaddress=新开端口的绑定地址 connectaddress=要转发的地址 connectport=要转发的端口 protocol=tcp    
  删除端口转发的命令      netsh interface portproxy delete v4tov4 listenport=新开的监听端口 listenaddress=新开端口的绑定地址    
  
   命令举例
    比方说，俺本地已经运行了 Tor，端口是 
   8118
   ，绑定在 
   127.0.0.1
    如果俺希望建立一个新的端口，端口号是 
   12345
   （这个端口号是俺随手编的，你也可以用其它端口号），绑定在 
   0.0.0.0
   上，那么就执行如下命令。然后，发往 
   12345
   端口的数据流就会被转发到 
   8118
   端口。      netsh interface portproxy add v4tov4 listenport=12345 listenaddress=0.0.0.0 connectaddress=127.0.0.1 connectport=8118 protocol=tcp    
  为了保险起见，再用前面介绍的 netstat 命令，看一下本机开启的端口。如果正常的话，你就可以看到如下一行输出      TCP  0.0.0.0:12345  0.0.0.0:0  LISTENING    
  如果要删除该端口转发，就执行如下命令      netsh interface portproxy delete v4tov4 listenport=12345 listenaddress=0.0.0.0    
 删除之后，再用 
   netstat
   命令查一下，这个 
   12345
   的监听端口就看不到了   
   优点
    1. 无需安装任何第三方软件  2. 一旦设置好就会持续有效——即使系统重新启动也没关系。   
   缺点
    1. 需要以管理员身份登录，才能执行上述命令。  2. 该方法只能用于 Windows 系统。        ◇利用 rinetd 
  
   获取软件
    rinetd 是一个很小巧的、跨平台的、开源的工具，它能提供 TCP 端口转发的功能。它的官网在“  这里  ”，上面提供了 Linux 平台和 Windows 平台的软件包。考虑到大多数同学用的是 Windows，俺针对 Windows 的使用介绍一下。  把那个 
   rinetd.zip
   下载到本地，解压出来，里面有好几个文件（包括源代码）。你只需取出其中的 
   rinetd.exe
   其它文件【不】需要。   
   编写配置文件
    rinetd 的配置文件很简单，就是一个普通的文本文件，每一行对应一条转发规则。每一条转发规则包含4个字段，分别如下，字段之间用 
   空格
   分开。      绑定地址 监听端口 转发的地址 转发的端口    
  
   配置文件举例
    举个例子：俺本地已经运行了 Tor，监听端口是 
   9150
   ，绑定在 
   127.0.0.1
    如果俺希望通过 rinetd 建立一个新的端口，端口号是 
   12345
   （这个端口号是俺随手编的，你也可以用其它端口号），绑定在 
   0.0.0.0
   上，那么，转发规则就这么写：      0.0.0.0 12345 127.0.0.1 9150    
  
   运行
    1. 把刚才写好的配置文件保存成 
   config.txt
   （俺只是举例，你也可以用其它文件名），把该文件跟 
   rinetd.exe
   放到【同一个目录】。  2. 运行 
   cmd
   进入 Windows 的命令行窗口（黑窗口）  3. 使用 
   cd
   命令切换当前目录，使得“当前目录”是 
   rinetd.exe
   所在的目录（不会用 
   cd
   命令的同学，请自行 Google 之）  4. 然后执行如下命令      rinetd.exe -c config.txt    
  
   上述命令执行之后，命令行窗口的光标会停止不动。不要以为 rinetd 死了，其实它已经开始工作。【这时候千万不要关闭这个 cmd 窗口】
   。为了保险起见，另外开一个 cmd 窗口，再用前面介绍的 
   netstat
   命令，看一下本机开启的端口。如果正常的话，你就可以看到如下一行输出      TCP  0.0.0.0:12345  0.0.0.0:0  LISTENING    
  
   优点
    1. 该软件很小巧（整个下载包才 100 多 KB），而且是绿色软件。几乎不占用啥系统资源  2. 无需管理员即可运行  3. 跨平台   
   缺点
    1. 每次你关机或用户注销，rinetd 就退出了，下次要用还得重新运行（为了方便，你可以把 rinetd 的启动命令加入 Windows 的启动项）         ★如何共享【VPN 类】的翻墙工具？ 
       ◇问题 
  用 VPN 翻墙，虽然可以让本机的所有网络软件自动通过 VPN 服务器中转。但是其它电脑的软件无法使用本机的 VPN 网络。        ◇解决方案之“Privoxy” 
  “VPN 翻墙”跟“代理翻墙”的技术原理不同——VPN 软件本身是不开启监听端口的。所以刚才介绍的端口转发，对于 VPN 软件是无效滴！  不过没关系，咱们可以在本机运行 Web 代理或 SOCKS 代理，把监听端口绑定到 
   0.0.0.0
   ，就可以让其它电脑的软件通过本机的 VPN 翻墙。考虑到大部分人翻墙都是为了浏览网页，俺重点介绍一下 Privoxy 这个工具。   
   获取软件
    Privoxy 是一个老牌的、跨平台的，开源的 Web 代理软件，官网在“  这里  ”。  在官网上有 exe 安装包，也有 zip 的压缩包（免安装）。下载哪个看你自己的喜好（俺喜欢免安装的，比较绿色）。   
   修改配置文件
    Privoxy 默认的监听端口是8118，绑定在 
   127.0.0.1
   上。为了让其它电脑能连上来，需要修改绑定的地址。  Privoxy 的配置文件是 
   config.txt
   。打开它，搜索 
   listen-address
   会看到如下一行：      listen-address  127.0.0.1:8118    
 然后修改为如下，既可。      listen-address  0.0.0.0:8118    
  
   运行
    直接双击 
   privoxy.exe
    为了保险起见，再用前面介绍的 
   netstat
   命令，看一下本机开启的端口。如果正常的话，你就可以看到如下这行输出：      TCP  0.0.0.0:8118  0.0.0.0:0  LISTENING    
  引申阅读：  Privoxy 是一款功能很强大的工具。为了帮大伙儿更好地利用它，俺后来又专门发了一篇《  如何用 Privoxy 辅助翻墙？  》，有兴趣的同学可以去看一下。         ★如何共享【虚拟机中】的翻墙软件 
  （还不了解虚拟机的同学，可以先看俺写的《  扫盲操作系统虚拟机  》系列教程）  有些网友（包括俺）会单独开一个虚拟机（Guest OS），专门用来安装翻墙工具。在这个虚拟机上，除了翻墙工具，不放其它任何东西。这样做的好处之一是：即使某些翻墙工具有后门，也不会威胁到真实系统（Host OS）的安全。  那么，如何把虚拟机中的翻墙工具共享给其它电脑（Host OS 之外的系统）用捏？        ◇步骤1 
  首先，你还是需要参照前面介绍的方法：  如果用代理翻墙，就搞端口转发；  如果用 VPN 翻墙，就新开一个 Web 代理。        ◇步骤2 
  配置虚拟机的网卡模式，可以有两种搞法。   
   对于 NAT 模式的网卡
    你需要添加端口映射。主流的虚拟机软件（包括 VMware 和 VirtualBox）都有此功能。  该功能类似于刚才提到的【端口转发】，其原理是：把 Host OS 上的某个端口映射到某个虚拟机的 NAT 网卡上的另一个端口。  该方法配置稍嫌麻烦。如果你对网络和虚拟机不太熟悉，俺不推荐用这种搞法，还是改用 Bridge 模式比较省事儿。   
   对于 Bridge 模式的网卡
    如果网卡是 Bridge 模式，那就简单啦—— 
   无需任何额外设置
   。  因为这种模式的虚拟网卡，对于 Host OS 之外的网络是可见的。也就是说，（Host OS 之外的）其它电脑可以直接访问到此网卡——因此其它电脑的软件就能直接连上虚拟机中的代理端口。        ◇引申阅读 
  上述这个招数采用的是【代理/proxy】的方式共享翻墙通道。这个招数有一个前提，就是你的上网软件要有“代理功能”（也就是——能通过软件的“界面”或“配置文件”设置代理）。  万一你使用的网络软件【没有】“代理功能”，咋办捏？请看下面这篇教程：  《  如何让【不支持】代理的网络软件，通过代理进行联网（不同平台的 N 种方法）  》         ★结尾 
  暂且写到这里。如果列位看官针对此话题有啥疑问，或者在实践过程中碰到啥困难，可以到俺博客留言。俺（有空的话）会尽量解答；有些热心读者也会帮忙解答。    
   俺博客上，和本文相关的帖子（需翻墙）
   ：  《  如何翻墙  》（传说中的扫盲教程，定期更新）  《  获取翻墙软件方法大全  》（教你在无法翻墙的情况下拿到翻墙软件）  《  如何让【不支持】代理的网络软件，通过代理进行联网（不同平台的 N 种方法）  》  《  如何用 Privoxy 辅助翻墙？  》  《  扫盲 Linux＆UNIX 命令行——从“电传打字机”聊到“shell 脚本编程”  》  《  扫盲 netcat（网猫）的 N 种用法——从“网络诊断”到“系统入侵”  》     

    版权声明
     本博客所有的原创文章，作者皆保留版权。转载必须包含本声明，保持本文完整，并以超链接形式注明作者  编程随想  和本文原始地址：   https://program-think.blogspot.com/2013/01/cross-host-use-gfw-tool.html 
    
    
  
  
    
         
    
    
    
 
    
  

&tags=觀點" class="ssk ssk-tumblr"></a>
    <a href="https://buffer.com/add?text=多台电脑如何【共享】翻墙通道——兼谈【端口转发】的几种方法&url=https://program-think.blogspot.com/2013/01/cross-host-use-gfw-tool.html" class="ssk ssk-buffer"></a>
</div>


    <div id="main" role="main" class="container">
      
  <!-- Html Elements for Search -->
  <ul id="results-container" class="searched" style="color: #2980B9;"></ul>

  <script src="/opinion/assets/js/simple-jekyll-search.min.js"></script>

  <!-- Configuration -->
  <script>
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('results-container'),
    json: '/opinion/search.json',
    searchResultTemplate: '<li><a href="{url}" title="{desc}">{title}</a><time>{date}</time><a class="tag">{category}</a></li>',
    noResultsText: '没找到',
    limit: 100,
    fuzzy: false,
    exclude: ['Welcome']
  })

  </script>

      







  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
    


  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
  
  

  
    



<article class="post">
  <h1>多台电脑如何【共享】翻墙通道——兼谈【端口转发】的几种方法</h1>
  <!-- Look the author details up from the site config. -->
  

  <div>
    <span class="date">
      2013-01-23
    </span>

    <!-- Output author details if some exist. -->
    
      
    


    <ul class="tag">
      <li>
        <a href="https://nodebe4.github.io/opinion/categories/#编程随想">
          编程随想
        </a>
      </li>
    </ul>

    
        <span>
            <!-- Personal Info. -->
            <a href="https://program-think.blogspot.com/2013/01/cross-host-use-gfw-tool.html" style="font-size:14px;">原文</a>
        </span>
    

    <span style="float: right;" title="编程随想的其它文章">
      <a style="font-size: 14px;" rel="nofollow" href="#sametag" class="tags">#编程随想 的其它文章</a>
    </span>

  </div>

  <div class="entry">
    
    
    
    <div class="post hentry uncustomized-post-template">
<a name="886551873384763161">
 </a>   <h1 class="post-title entry-title" id="section"> <a href="https://program-think.blogspot.com/2013/01/cross-host-use-gfw-tool.html"> 多台电脑如何【共享】翻墙通道——兼谈【端口转发】的几种方法 </a> </h1>
  <div class="post-header">
    <div class="post-header-line-1">
      <div class="post-inner-index"></div>
    </div>
  </div>
  <div class="post-body entry-content">
    <h2 id="section-1"> ★引子 </h2>
 <br /> 元旦前后，俺写了《 <a href="https://program-think.blogspot.com/2010/04/howto-cover-your-tracks-0.html"> 如何隐藏你的踪迹，避免跨省追捕 </a> 》系列的第6、7篇——《用虚拟机隐匿公网IP》。之后有不少网友到博客留言，询问如何让不同虚拟机的软件共享翻墙代理。 <br /> 所以，俺今天就来聊一聊“多台电脑共享翻墙通道”这个话题。今天介绍的招数，既可以在不同虚拟机之间共享翻墙通道，也可以在不同的实体机（包括PC、平板、手机）之间共享翻墙通道。 <br /> <a name="more">
  </a>     <!--program-think-->
 <br /> <br />     <h2 id="section-2"> ★预备知识 ＆ 准备工作 </h2>
 <br /> 考虑到俺博客的读者，有很多人【不是】IT 技术人员。所以，俺先通俗地扫盲若干基础知识。 <br /> <br />     <h3 id="section-3"> ◇啥是“翻墙”？ </h3>
 <br /> 如果你对“翻墙”还不太了解，建议你先看看俺写的《 <a href="https://program-think.blogspot.com/2009/05/how-to-break-through-gfw.html"> 如何翻墙 </a> 》一文。这篇扫盲教程可以说是面面俱到，很适合翻墙方面的新手入门。 <br /> <br />     <h3 id="section-4"> ◇啥是“代理”？ </h3>
 <br /> “代理”好比是一个中转站，可以中转你的上网数据流量，以此来避开 GFW 这堵墙。 <br /> 翻墙代理通常包括两部分：代理软件，代理服务器。代理软件安装在你的电脑上，代理服务器通常都位于墙外（也就是境外）。当你通过代理上网时，你的浏览器并不是直接连到目标网站。而是通过如下几个步骤： <br /> 1. 浏览器发送数据到代理软件 <br /> 2. 代理软件把你的数据发送到墙外的代理服务器 <br /> 3. 代理服务器发送数据到目标网站 <br /> <br />     <h3 id="section-5"> ◇啥是“监听端口”？ </h3>
 <br /> 代理软件要正常工作，通常都需要开启一个“监听端口”。浏览器通过这个“监听端口”来跟代理软件建立连接。只有建立了连接，浏览器才能把数据发送到代理软件上。端口号是一个数字，范围在 <code class="language-plaintext highlighter-rouge">
   1
  </code> 至 <code class="language-plaintext highlighter-rouge">
   65535
  </code> 之间。 <br /> <br />     <h3 id="section-6"> ◇如何看本机开启的监听端口？ </h3>
 <br /> 对于 Windows 系统，在命令行窗口（先运行 cmd 就会出现命令行窗口）运行如下命令，可以看到本机开启的【所有】监听端口。 <br />     <div class="language-plaintext shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>netstat -an | find "LISTEN"</code></pre></div>    </div>
 <br /> 刚才有读者在留言中提问，俺再补充一下。用 <code class="language-plaintext highlighter-rouge">
   netstat
  </code> 的 <code class="language-plaintext highlighter-rouge">
   o
  </code> 选项可以看到每个监听端口分别是【哪个进程】开启滴。命令如下 <br />     <div class="language-plaintext shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>netstat -ano | find "LISTEN"</code></pre></div>    </div>
 <br /> 对于 POSIX 系统（Linux ＆ UNIX），把上述命令中的 <code class="language-plaintext highlighter-rouge">
   find
  </code> 改为 <code class="language-plaintext highlighter-rouge">
   grep
  </code> ，具体如下： <br />     <div class="language-plaintext shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>netstat -an | grep "LISTEN"</code></pre></div>    </div>
 <br />     <h3 id="section-7"> ◇什么是监听端口的“绑定地址”？ </h3>
 <br /> 以俺手头的虚拟机为例，执行刚才那个命令后，会显示如下输出 <br />     <div class="language-plaintext shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>TCP  127.0.0.1:8118  0.0.0.0:0  LISTENING</code></pre></div>    </div>
 <br /> 其中的 <code class="language-plaintext highlighter-rouge">
   127.0.0.1
  </code> 表示这个监听端口绑定的网卡地址，而 <code class="language-plaintext highlighter-rouge">
   8118
  </code> 表示监听的端口号。所谓的“绑定地址”，意思就是说，这个监听端口只接受来自该网卡的连接。 <br /> 因为 <code class="language-plaintext highlighter-rouge">
   127.0.0.1
  </code> 表示本机网卡地址；所以，绑定在 <code class="language-plaintext highlighter-rouge">
   127.0.0.1
  </code> 表示该监听端口只接受来自本机的连接。 <br /> 如果要让某个监听端口接受任意连接（包括外部电脑的连接），把绑定地址设置为 <code class="language-plaintext highlighter-rouge">
   0.0.0.0
  </code> 即可。 <br /> <br />     <h3 id="section-8"> ◇小心防火墙的配置 </h3>
 <br /> 在《 <a href="https://program-think.blogspot.com/2013/01/howto-cover-your-tracks-7.html"> 用虚拟机隐匿公网IP </a> 》一文，俺就特别用红字，提醒大伙儿要小心防火墙的设置。结果还是有很多人因为防火墙的问题而中招，功亏一篑。 <br /> 俺再啰嗦一下： <span style="color:red;font-weight:bold;"> 要特别小心操作系统中防火墙的设置 </span> 。很多人是因为防火墙没设好，导致代理无法连通。 <br /> 如果你使用本文介绍的招数，却总是搞不定，可以参考下面的教程，用 netcat 诊断一下。 <br /> 《 <a href="https://program-think.blogspot.com/2019/09/Netcat-Tricks.html"> 扫盲 netcat（网猫）的 N 种用法——从“网络诊断”到“系统入侵” </a> 》 <br /> <br /> <br />     <h2 id="section-9"> ★如何共享【代理类】的翻墙工具？ </h2>
 <br />     <h3 id="section-10"> ◇问题 </h3>
 <br /> 大部分翻墙代理都会提供一个 TCP 的代理端口（就是刚才说的“监听端口”）。问题在于：很多翻墙代理的代理端口都绑定在 <code class="language-plaintext highlighter-rouge">
   127.0.0.1
  </code> 上。也就是说，这个代理只能被本机的软件使用，外部电脑的软件无法连接到该端口。 <br /> <br />     <h3 id="section-11"> ◇解决方案之“修改配置” </h3>
 <br /> 最简单的解决方案，就是修改翻墙软件的配置，让代理端口绑定到 <code class="language-plaintext highlighter-rouge">
   0.0.0.0
  </code> 上。 <br /> <br /> <b>
   自由门
  </b> <br /> 到它的设置界面，点“更多设置”，然后勾选“用自由门做服务器”，可以把监听端口绑定到 <code class="language-plaintext highlighter-rouge">
   0.0.0.0
  </code> <br /> <br /> <b>
   GoAgent
  </b> <br /> GoAgent 的配置信息存储在 <code class="language-plaintext highlighter-rouge">
   proxy.ini
  </code> 文件中。打开该文件找到 <code class="language-plaintext highlighter-rouge">
   [listen]
  </code> 字段，然后把该字段下面的 <code class="language-plaintext highlighter-rouge">
   127.0.0.1
  </code> 改为 <code class="language-plaintext highlighter-rouge">
   0.0.0.0
  </code> 即可。 <br /> <br /> 可惜的是，很多翻墙软件都没有提供配置文件让你修改监听端口绑定的地址。所以，俺下面传授一个通用的招数，【无需】修改配置文件，可以【 <b>
   搞定任何翻墙代理
  </b> 】，让它的监听端口被外部电脑使用。 <br /> <br />     <h3 id="section-12"> ◇解决方案之“端口转发” </h3>
 <br /> 所谓的“端口转发”，通俗地说就是让 A 监听端口的数据转发到 B 监听端口。 <br /> B 监听端口就是你的翻墙软件原先开启的端口 <br /> A 监听端口是新开的，而且绑定地址是 <code class="language-plaintext highlighter-rouge">
   0.0.0.0
  </code> <br /> 如此一来，外部电脑就可以用 A 端口作为代理的端口，数据都发给 A 端口，然后利用“端口转发”功能，把数据转向 B 端口（也就是翻墙工具自身的端口） <br /> <br /> <br />     <h2 id="section-13"> ★如何搞【端口转发】？ </h2>
 <br /> （这招是本文的重点，单独开一个章节来细说） <br /> “端口转发”有时候也称为“端口映射”，洋文称为“port forwarding”。提及该术语，一般都是指 TCP 协议，有时候也称之为“TCP forward”或“TCP redirection”。 <br /> 用来搞端口转发的工具有很多，如果你去 Google 一下相关术语，应该能找到一大堆软件或解决方案。考虑到很多读者是菜鸟，俺挑选两种最简单的办法。 <br /> <br />     <h3 id="windows--netsh-"> ◇利用 Windows 自带的 netsh </h3>
 <br /> <b>
   准备工作
  </b> <br /> 对于 Vista 以及更新版本的 Windows （比如 Win7 Win8 ...）可以直接使用该方案。 <br /> 对于 Vista 【之前】的 Windows（比如 WinXP、Win2003），需要先安装【IPv6 协议栈】，具体步骤如下： <br /> 1. 以管理员身份登录，进入“控制面板”下面的“网络连接” <br /> 2. 选中本地连接，点右键，在右键菜单选“属性” <br /> 3. 弹出“属性”对话框，点“安装”按钮 <br /> 4. 弹出“选择网络组件类型”对话框，选“协议”，再点“添加”按钮 <br /> 5. 在弹出的对话框中选“IPv6”，点“确定”就 OK 啦 <br /> <br /> <b>
   命令详解
  </b> <br /> （以下命令需要管理员身份才能执行） <br /> 添加端口转发的命令 <br />     <div class="language-plaintext shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>netsh interface portproxy add v4tov4 listenport=新开的监听端口 listenaddress=新开端口的绑定地址 connectaddress=要转发的地址 connectport=要转发的端口 protocol=tcp</code></pre></div>    </div>
 <br /> 删除端口转发的命令 <br />     <div class="language-plaintext shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>netsh interface portproxy delete v4tov4 listenport=新开的监听端口 listenaddress=新开端口的绑定地址</code></pre></div>    </div>
 <br /> <b>
   命令举例
  </b> <br /> 比方说，俺本地已经运行了 Tor，端口是 <code class="language-plaintext highlighter-rouge">
   8118
  </code> ，绑定在 <code class="language-plaintext highlighter-rouge">
   127.0.0.1
  </code> <br /> 如果俺希望建立一个新的端口，端口号是 <code class="language-plaintext highlighter-rouge">
   12345
  </code> （这个端口号是俺随手编的，你也可以用其它端口号），绑定在 <code class="language-plaintext highlighter-rouge">
   0.0.0.0
  </code> 上，那么就执行如下命令。然后，发往 <code class="language-plaintext highlighter-rouge">
   12345
  </code> 端口的数据流就会被转发到 <code class="language-plaintext highlighter-rouge">
   8118
  </code> 端口。 <br />     <div class="language-plaintext shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>netsh interface portproxy add v4tov4 listenport=12345 listenaddress=0.0.0.0 connectaddress=127.0.0.1 connectport=8118 protocol=tcp</code></pre></div>    </div>
 <br /> 为了保险起见，再用前面介绍的 netstat 命令，看一下本机开启的端口。如果正常的话，你就可以看到如下一行输出 <br />     <div class="language-plaintext shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>TCP  0.0.0.0:12345  0.0.0.0:0  LISTENING</code></pre></div>    </div>
 <br /> 如果要删除该端口转发，就执行如下命令 <br />     <div class="language-plaintext shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>netsh interface portproxy delete v4tov4 listenport=12345 listenaddress=0.0.0.0</code></pre></div>    </div>
 删除之后，再用 <code class="language-plaintext highlighter-rouge">
   netstat
  </code> 命令查一下，这个 <code class="language-plaintext highlighter-rouge">
   12345
  </code> 的监听端口就看不到了 <br /> <br /> <b>
   优点
  </b> <br /> 1. 无需安装任何第三方软件 <br /> 2. 一旦设置好就会持续有效——即使系统重新启动也没关系。 <br /> <br /> <b>
   缺点
  </b> <br /> 1. 需要以管理员身份登录，才能执行上述命令。 <br /> 2. 该方法只能用于 Windows 系统。 <br /> <br />     <h3 id="rinetd-"> ◇利用 rinetd </h3>
 <br /> <b>
   获取软件
  </b> <br /> rinetd 是一个很小巧的、跨平台的、开源的工具，它能提供 TCP 端口转发的功能。它的官网在“ <a href="https://www.boutell.com/rinetd/" rel="nofollow" target="_blank"> 这里 </a> ”，上面提供了 Linux 平台和 Windows 平台的软件包。考虑到大多数同学用的是 Windows，俺针对 Windows 的使用介绍一下。 <br /> 把那个 <code class="language-plaintext highlighter-rouge">
   rinetd.zip
  </code> 下载到本地，解压出来，里面有好几个文件（包括源代码）。你只需取出其中的 <code class="language-plaintext highlighter-rouge">
   rinetd.exe
  </code> 其它文件【不】需要。 <br /> <br /> <b>
   编写配置文件
  </b> <br /> rinetd 的配置文件很简单，就是一个普通的文本文件，每一行对应一条转发规则。每一条转发规则包含4个字段，分别如下，字段之间用 <b>
   空格
  </b> 分开。 <br />     <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>绑定地址 监听端口 转发的地址 转发的端口</code></pre></div>    </div>
 <br /> <b>
   配置文件举例
  </b> <br /> 举个例子：俺本地已经运行了 Tor，监听端口是 <code class="language-plaintext highlighter-rouge">
   9150
  </code> ，绑定在 <code class="language-plaintext highlighter-rouge">
   127.0.0.1
  </code> <br /> 如果俺希望通过 rinetd 建立一个新的端口，端口号是 <code class="language-plaintext highlighter-rouge">
   12345
  </code> （这个端口号是俺随手编的，你也可以用其它端口号），绑定在 <code class="language-plaintext highlighter-rouge">
   0.0.0.0
  </code> 上，那么，转发规则就这么写： <br />     <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.0.0.0 12345 127.0.0.1 9150</code></pre></div>    </div>
 <br /> <b>
   运行
  </b> <br /> 1. 把刚才写好的配置文件保存成 <code class="language-plaintext highlighter-rouge">
   config.txt
  </code> （俺只是举例，你也可以用其它文件名），把该文件跟 <code class="language-plaintext highlighter-rouge">
   rinetd.exe
  </code> 放到【同一个目录】。 <br /> 2. 运行 <code class="language-plaintext highlighter-rouge">
   cmd
  </code> 进入 Windows 的命令行窗口（黑窗口） <br /> 3. 使用 <code class="language-plaintext highlighter-rouge">
   cd
  </code> 命令切换当前目录，使得“当前目录”是 <code class="language-plaintext highlighter-rouge">
   rinetd.exe
  </code> 所在的目录（不会用 <code class="language-plaintext highlighter-rouge">
   cd
  </code> 命令的同学，请自行 Google 之） <br /> 4. 然后执行如下命令 <br />     <div class="language-plaintext shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rinetd.exe -c config.txt</code></pre></div>    </div>
 <br /> <b>
   上述命令执行之后，命令行窗口的光标会停止不动。不要以为 rinetd 死了，其实它已经开始工作。【这时候千万不要关闭这个 cmd 窗口】
  </b> 。为了保险起见，另外开一个 cmd 窗口，再用前面介绍的 <code class="language-plaintext highlighter-rouge">
   netstat
  </code> 命令，看一下本机开启的端口。如果正常的话，你就可以看到如下一行输出 <br />     <div class="language-plaintext shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>TCP  0.0.0.0:12345  0.0.0.0:0  LISTENING</code></pre></div>    </div>
 <br /> <b>
   优点
  </b> <br /> 1. 该软件很小巧（整个下载包才 100 多 KB），而且是绿色软件。几乎不占用啥系统资源 <br /> 2. 无需管理员即可运行 <br /> 3. 跨平台 <br /> <br /> <b>
   缺点
  </b> <br /> 1. 每次你关机或用户注销，rinetd 就退出了，下次要用还得重新运行（为了方便，你可以把 rinetd 的启动命令加入 Windows 的启动项） <br /> <br /> <br />     <h2 id="vpn--"> ★如何共享【VPN 类】的翻墙工具？ </h2>
 <br />     <h3 id="section-14"> ◇问题 </h3>
 <br /> 用 VPN 翻墙，虽然可以让本机的所有网络软件自动通过 VPN 服务器中转。但是其它电脑的软件无法使用本机的 VPN 网络。 <br /> <br />     <h3 id="privoxy-"> ◇解决方案之“Privoxy” </h3>
 <br /> “VPN 翻墙”跟“代理翻墙”的技术原理不同——VPN 软件本身是不开启监听端口的。所以刚才介绍的端口转发，对于 VPN 软件是无效滴！ <br /> 不过没关系，咱们可以在本机运行 Web 代理或 SOCKS 代理，把监听端口绑定到 <code class="language-plaintext highlighter-rouge">
   0.0.0.0
  </code> ，就可以让其它电脑的软件通过本机的 VPN 翻墙。考虑到大部分人翻墙都是为了浏览网页，俺重点介绍一下 Privoxy 这个工具。 <br /> <br /> <b>
   获取软件
  </b> <br /> Privoxy 是一个老牌的、跨平台的，开源的 Web 代理软件，官网在“ <a href="http://www.privoxy.org/" rel="nofollow" target="_blank"> 这里 </a> ”。 <br /> 在官网上有 exe 安装包，也有 zip 的压缩包（免安装）。下载哪个看你自己的喜好（俺喜欢免安装的，比较绿色）。 <br /> <br /> <b>
   修改配置文件
  </b> <br /> Privoxy 默认的监听端口是8118，绑定在 <code class="language-plaintext highlighter-rouge">
   127.0.0.1
  </code> 上。为了让其它电脑能连上来，需要修改绑定的地址。 <br /> Privoxy 的配置文件是 <code class="language-plaintext highlighter-rouge">
   config.txt
  </code> 。打开它，搜索 <code class="language-plaintext highlighter-rouge">
   listen-address
  </code> 会看到如下一行： <br />     <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>listen-address  127.0.0.1:8118</code></pre></div>    </div>
 然后修改为如下，既可。 <br />     <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>listen-address  0.0.0.0:8118</code></pre></div>    </div>
 <br /> <b>
   运行
  </b> <br /> 直接双击 <code class="language-plaintext highlighter-rouge">
   privoxy.exe
  </code> <br /> 为了保险起见，再用前面介绍的 <code class="language-plaintext highlighter-rouge">
   netstat
  </code> 命令，看一下本机开启的端口。如果正常的话，你就可以看到如下这行输出： <br />     <div class="language-plaintext shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>TCP  0.0.0.0:8118  0.0.0.0:0  LISTENING</code></pre></div>    </div>
 <br /> 引申阅读： <br /> Privoxy 是一款功能很强大的工具。为了帮大伙儿更好地利用它，俺后来又专门发了一篇《 <a href="https://program-think.blogspot.com/2014/12/gfw-privoxy.html"> 如何用 Privoxy 辅助翻墙？ </a> 》，有兴趣的同学可以去看一下。 <br /> <br /> <br />     <h2 id="section-15"> ★如何共享【虚拟机中】的翻墙软件 </h2>
 <br /> （还不了解虚拟机的同学，可以先看俺写的《 <a href="https://program-think.blogspot.com/2012/10/system-vm-0.html"> 扫盲操作系统虚拟机 </a> 》系列教程） <br /> 有些网友（包括俺）会单独开一个虚拟机（Guest OS），专门用来安装翻墙工具。在这个虚拟机上，除了翻墙工具，不放其它任何东西。这样做的好处之一是：即使某些翻墙工具有后门，也不会威胁到真实系统（Host OS）的安全。 <br /> 那么，如何把虚拟机中的翻墙工具共享给其它电脑（Host OS 之外的系统）用捏？ <br /> <br />     <h3 id="section-16"> ◇步骤1 </h3>
 <br /> 首先，你还是需要参照前面介绍的方法： <br /> 如果用代理翻墙，就搞端口转发； <br /> 如果用 VPN 翻墙，就新开一个 Web 代理。 <br /> <br />     <h3 id="section-17"> ◇步骤2 </h3>
 <br /> 配置虚拟机的网卡模式，可以有两种搞法。 <br /> <br /> <b>
   对于 NAT 模式的网卡
  </b> <br /> 你需要添加端口映射。主流的虚拟机软件（包括 VMware 和 VirtualBox）都有此功能。 <br /> 该功能类似于刚才提到的【端口转发】，其原理是：把 Host OS 上的某个端口映射到某个虚拟机的 NAT 网卡上的另一个端口。 <br /> 该方法配置稍嫌麻烦。如果你对网络和虚拟机不太熟悉，俺不推荐用这种搞法，还是改用 Bridge 模式比较省事儿。 <br /> <br /> <b>
   对于 Bridge 模式的网卡
  </b> <br /> 如果网卡是 Bridge 模式，那就简单啦—— <b>
   无需任何额外设置
  </b> 。 <br /> 因为这种模式的虚拟网卡，对于 Host OS 之外的网络是可见的。也就是说，（Host OS 之外的）其它电脑可以直接访问到此网卡——因此其它电脑的软件就能直接连上虚拟机中的代理端口。 <br /> <br />     <h3 id="section-18"> ◇引申阅读 </h3>
 <br /> 上述这个招数采用的是【代理/proxy】的方式共享翻墙通道。这个招数有一个前提，就是你的上网软件要有“代理功能”（也就是——能通过软件的“界面”或“配置文件”设置代理）。 <br /> 万一你使用的网络软件【没有】“代理功能”，咋办捏？请看下面这篇教程： <br /> 《 <a href="https://program-think.blogspot.com/2019/04/Proxy-Tricks.html"> 如何让【不支持】代理的网络软件，通过代理进行联网（不同平台的 N 种方法） </a> 》 <br /> <br /> <br />     <h2 id="section-19"> ★结尾 </h2>
 <br /> 暂且写到这里。如果列位看官针对此话题有啥疑问，或者在实践过程中碰到啥困难，可以到俺博客留言。俺（有空的话）会尽量解答；有些热心读者也会帮忙解答。 <br /> <br /> <br /> <b>
   俺博客上，和本文相关的帖子（需翻墙）
  </b> ： <br /> 《 <a href="https://program-think.blogspot.com/2009/05/how-to-break-through-gfw.html"> 如何翻墙 </a> 》（传说中的扫盲教程，定期更新） <br /> 《 <a href="https://program-think.blogspot.com/2011/03/how-to-get-gfw-tools.html"> 获取翻墙软件方法大全 </a> 》（教你在无法翻墙的情况下拿到翻墙软件） <br /> 《 <a href="https://program-think.blogspot.com/2019/04/Proxy-Tricks.html"> 如何让【不支持】代理的网络软件，通过代理进行联网（不同平台的 N 种方法） </a> 》 <br /> 《 <a href="https://program-think.blogspot.com/2014/12/gfw-privoxy.html"> 如何用 Privoxy 辅助翻墙？ </a> 》 <br /> 《 <a href="https://program-think.blogspot.com/2019/11/POSIX-TUI-from-TTY-to-Shell-Programming.html"> 扫盲 Linux＆UNIX 命令行——从“电传打字机”聊到“shell 脚本编程” </a> 》 <br /> 《 <a href="https://program-think.blogspot.com/2019/09/Netcat-Tricks.html"> 扫盲 netcat（网猫）的 N 种用法——从“网络诊断”到“系统入侵” </a> 》     <div class="post-copyright">
<b>
    版权声明
   </b> <br /> 本博客所有的原创文章，作者皆保留版权。转载必须包含本声明，保持本文完整，并以超链接形式注明作者 <a href="mailto:program.think@gmail.com"> 编程随想 </a> 和本文原始地址： <br /> <a href="https://program-think.blogspot.com/2013/01/cross-host-use-gfw-tool.html" id="OriginalPostUrl"> https://program-think.blogspot.com/2013/01/cross-host-use-gfw-tool.html </a>
    </div>
    <div style="clear: both;"></div>
  </div>
  <div class="post-footer" style="margin-bottom:50px;">
    <div class="post-footer-line post-footer-line-1" style="display:none;">
<span class="post-author vcard"> </span> <span class="reaction-buttons"> </span> <span class="star-ratings"> </span> <span class="post-icons"> </span> <span class="post-backlinks post-comment-link"> </span>
    </div>
    <div class="post-footer-line post-footer-line-2 post-toolbar"></div>
    <div class="post-footer-line post-footer-line-3">
<span class="post-location"> </span>
    </div>
  </div>
</div>


  </div>

  <hr style="border-top:1px solid #28323C;"/>

<font size=2px>
  文章版权归原作者所有。
</font>

<div style="text-align:center"><img width="1px" src="https://i.imgur.com/HSw56Ez.png" alt="二维码分享本站" style="text-align:center"/></div>

  <div id="sametag">
    <h4 style="display: inline-block;">#编程随想 的其它文章</h4>
    <span>--<a href="https://nodebe4.github.io/opinion/2021-05-09/%E5%88%86%E4%BA%AB%E5%90%84%E7%B1%BB%E7%94%B5%E5%AD%90%E4%B9%A6-%E6%94%BF%E6%B2%BB-IT-%E7%A7%91%E6%99%AE-%E5%8E%86%E5%8F%B2-%E7%AD%89-97%E6%9C%AC/">最新</a>-</span>
    <span>-<a href="https://nodebe4.github.io/opinion/2009-01-15/%E5%8D%9A%E5%AE%A2%E5%BC%80%E5%BC%A0%E5%8F%8A%E6%9C%AC%E5%8D%9A%E5%AE%A2%E5%86%85%E5%AE%B9%E7%AE%80%E4%BB%8B/">最早</a>--</span>
    
      <li>
        <time>2013-01-30</time>
        <a href="https://nodebe4.github.io/opinion/2013-01-30/%E5%9B%9E%E9%A1%BE%E5%85%AD%E5%9B%9B%E7%B3%BB%E5%88%97-22-%E5%BA%9F%E5%B8%9D%E8%B5%B5%E7%B4%AB%E9%98%B3%E5%85%B6%E4%BA%BA/">
          回顾六四系列[22]：废帝赵紫阳其人
        </a>
      </li>
    
    
      <li>
        <time>2013-01-26</time>
        <a href="https://nodebe4.github.io/opinion/2013-01-26/%E6%AF%8F%E5%91%A8%E8%BD%AC%E8%BD%BD-%E5%85%B3%E4%BA%8E%E6%9D%83%E5%8A%9B%E5%92%8C%E7%AC%BC%E5%AD%90-%E7%BD%91%E6%96%875%E7%AF%87/">
          每周转载：关于权力和笼子（网文5篇）
        </a>
      </li>
    
    
      <li>
        <time>2013-01-21</time>
        <a href="https://nodebe4.github.io/opinion/2013-01-21/%E6%AF%8F%E5%91%A8%E8%BD%AC%E8%BD%BD-%E5%85%B3%E4%BA%8E%E9%BB%91%E5%AE%A2%E6%96%87%E5%8C%96%E5%92%8C%E9%BB%91%E5%AE%A2%E7%B2%BE%E7%A5%9E/">
          每周转载：关于黑客文化和黑客精神
        </a>
      </li>
    
    
      <li>
        <time>2013-01-17</time>
        <a href="https://nodebe4.github.io/opinion/2013-01-17/%E5%88%86%E4%BA%AB%E6%94%BF%E6%B2%BB%E7%B1%BB%E7%94%B5%E5%AD%90%E4%B9%A6-22%E6%9C%AC/">
          分享政治类电子书（22本）
        </a>
      </li>
    
  </div>


  <hr>
  <div class="pagination">
    
      <span class="prev" >
          <a href="https://nodebe4.github.io/opinion/2013-01-23/%E9%80%9D%E8%80%85-%E5%8D%8E%E5%AE%89%E6%BE%9C-%E4%B8%AD%E5%9B%BD%E9%97%AE%E9%A2%98%E7%9A%84%E7%8E%B0%E5%AE%9E%E4%B8%BB%E4%B9%89%E7%A0%94%E7%A9%B6%E8%80%85/">
            前一篇：【逝者】华安澜：中国问题的现实主义研究者
          </a>
      </span>
    
    
      <span class="next" >
          <a href="https://nodebe4.github.io/opinion/2013-01-24/%E5%9B%BD%E4%BC%81%E7%94%B1%E8%B0%81%E6%8E%8C%E6%8E%A7/">
            後一篇：国企由谁掌控?
          </a>
      </span>
    

    <script>
    /* post pagination keyboard shortcuts */
    document.body.onkeyup = function(e){
      if (e.keyCode == '37') { window.location = 'https://nodebe4.github.io/opinion/2013-01-23/%E9%80%9D%E8%80%85-%E5%8D%8E%E5%AE%89%E6%BE%9C-%E4%B8%AD%E5%9B%BD%E9%97%AE%E9%A2%98%E7%9A%84%E7%8E%B0%E5%AE%9E%E4%B8%BB%E4%B9%89%E7%A0%94%E7%A9%B6%E8%80%85/'; } // left arrow key
      if (e.keyCode == '39') { window.location = 'https://nodebe4.github.io/opinion/2013-01-24/%E5%9B%BD%E4%BC%81%E7%94%B1%E8%B0%81%E6%8E%8C%E6%8E%A7/'; } // right arrow key
      if (e.keyCode == '45') { window.location = 'https://nodebe4.github.io/opinion/2013-01-26/%E6%AF%8F%E5%91%A8%E8%BD%AC%E8%BD%BD-%E5%85%B3%E4%BA%8E%E6%9D%83%E5%8A%9B%E5%92%8C%E7%AC%BC%E5%AD%90-%E7%BD%91%E6%96%875%E7%AF%87/'; } // insert key
      if (e.keyCode == '46') { window.location = 'https://nodebe4.github.io/opinion/2013-01-21/%E6%AF%8F%E5%91%A8%E8%BD%AC%E8%BD%BD-%E5%85%B3%E4%BA%8E%E9%BB%91%E5%AE%A2%E6%96%87%E5%8C%96%E5%92%8C%E9%BB%91%E5%AE%A2%E7%B2%BE%E7%A5%9E/'; } // delete key
    };
    </script>
    <link rel="stylesheet" type="text/css" href="/opinion/assets/css/fab.css" />

<div class="fab-wrapper">
  <div class="fab-wheel">
    
    
    
    <a class="fab-action fab-action-1" title="上一篇(热键 &#8594;)" href="https://nodebe4.github.io/opinion/2013-01-23/%E9%80%9D%E8%80%85-%E5%8D%8E%E5%AE%89%E6%BE%9C-%E4%B8%AD%E5%9B%BD%E9%97%AE%E9%A2%98%E7%9A%84%E7%8E%B0%E5%AE%9E%E4%B8%BB%E4%B9%89%E7%A0%94%E7%A9%B6%E8%80%85/">
      <i>后</i>
    </a>
    
    
    <a class="fab-action fab-action-2" title="下一篇(热键 &#8592;)" href="https://nodebe4.github.io/opinion/2013-01-24/%E5%9B%BD%E4%BC%81%E7%94%B1%E8%B0%81%E6%8E%8C%E6%8E%A7/">
      <i>前</i>
    </a>
    
    
    <a class="fab-action fab-action-3" title="<编程随想>上一篇(热键 ins)" href="https://nodebe4.github.io/opinion/2013-01-26/%E6%AF%8F%E5%91%A8%E8%BD%AC%E8%BD%BD-%E5%85%B3%E4%BA%8E%E6%9D%83%E5%8A%9B%E5%92%8C%E7%AC%BC%E5%AD%90-%E7%BD%91%E6%96%875%E7%AF%87/">
      <i>左</i>
    </a>
    
    
    <a class="fab-action fab-action-4" title="<编程随想>下一篇(热键 del)" href="https://nodebe4.github.io/opinion/2013-01-21/%E6%AF%8F%E5%91%A8%E8%BD%AC%E8%BD%BD-%E5%85%B3%E4%BA%8E%E9%BB%91%E5%AE%A2%E6%96%87%E5%8C%96%E5%92%8C%E9%BB%91%E5%AE%A2%E7%B2%BE%E7%A5%9E/">
      <i>右</i>
    </a>
    
  </div>
</div>


  </div>


  

</article>

    </div>

    <div style="z-index:2;">
<script src="/opinion/assets/js/vanilla-back-to-top.min.js"></script>
<script>addBackToTop({
  diameter: 56,
  cornerOffset: 20, // px
  id: 'back-to-top',
  backgroundColor: '#ddd',
  textColor: 'red'
})</script>
</div>


    <div class="wrapper-footer" id="footer">
      <div class="container">
        <footer class="footer">
          <img width="200px" src="https://i.imgur.com/HSw56Ez.png" alt="二维码分享本站"/>
<font size=2px>二维码分享本站</font>

<!-- Refer to https://codepen.io/ruandre/pen/howFi -->
<ul class="svg-icon">

  

  

  
  <li><a href="mailto:beauti4@protonmail.com" class="icon-8 email" title="Email"><svg viewBox="0 0 512 512"><path d="M101.3 141.6v228.9h0.3 308.4 0.8V141.6H101.3zM375.7 167.8l-119.7 91.5 -119.6-91.5H375.7zM127.6 194.1l64.1 49.1 -64.1 64.1V194.1zM127.8 344.2l84.9-84.9 43.2 33.1 43-32.9 84.7 84.7L127.8 344.2 127.8 344.2zM384.4 307.8l-64.4-64.4 64.4-49.3V307.8z"/></svg><!--[if lt IE 9]><em>Email</em><![endif]--></a></li>
  

  

  

  
  <li><a href="https://github.com/NodeBE4/opinion" class="icon-13 github" title="GitHub"><svg viewBox="0 0 512 512"><path d="M256 70.7c-102.6 0-185.9 83.2-185.9 185.9 0 82.1 53.3 151.8 127.1 176.4 9.3 1.7 12.3-4 12.3-8.9V389.4c-51.7 11.3-62.5-21.9-62.5-21.9 -8.4-21.5-20.6-27.2-20.6-27.2 -16.9-11.5 1.3-11.3 1.3-11.3 18.7 1.3 28.5 19.2 28.5 19.2 16.6 28.4 43.5 20.2 54.1 15.4 1.7-12 6.5-20.2 11.8-24.9 -41.3-4.7-84.7-20.6-84.7-91.9 0-20.3 7.3-36.9 19.2-49.9 -1.9-4.7-8.3-23.6 1.8-49.2 0 0 15.6-5 51.1 19.1 14.8-4.1 30.7-6.2 46.5-6.3 15.8 0.1 31.7 2.1 46.6 6.3 35.5-24 51.1-19.1 51.1-19.1 10.1 25.6 3.8 44.5 1.8 49.2 11.9 13 19.1 29.6 19.1 49.9 0 71.4-43.5 87.1-84.9 91.7 6.7 5.8 12.8 17.1 12.8 34.4 0 24.9 0 44.9 0 51 0 4.9 3 10.7 12.4 8.9 73.8-24.6 127-94.3 127-176.4C441.9 153.9 358.6 70.7 256 70.7z"/></svg><!--[if lt IE 9]><em>GitHub</em><![endif]--></a></li>
  

  

  

  

  

  
  <li><a href="/opinion/feed.xml" class="icon-21 rss" title="RSS"><svg viewBox="0 0 512 512"><path d="M201.8 347.2c0 20.3-16.5 36.8-36.8 36.8 -20.3 0-36.8-16.5-36.8-36.8s16.5-36.8 36.8-36.8C185.3 310.4 201.8 326.8 201.8 347.2zM128.2 204.7v54.5c68.5 0.7 124 56.3 124.7 124.7h54.5C306.7 285.3 226.9 205.4 128.2 204.7zM128.2 166.6c57.9 0.3 112.3 22.9 153.2 63.9 41 41 63.7 95.5 63.9 153.5h54.5c-0.3-149.9-121.7-271.4-271.6-271.9V166.6L128.2 166.6z"/></svg><!--[if lt IE 9]><em>RSS</em><![endif]--></a></li>
  

  

  

  

  

    
</ul>





<p><span style="color:blue">内容每小时更新一次.</span> Powered by <a href="https://github.com/AWEEKJ/kiko-now">Kiko Now</a> & <a href="https://github.com/gitalk/gitalk">Gitalk</a> & <a href="https://github.com/duty-machine/news">duty-machine</a>, 站务 <a href="https://be4.herokuapp.com">NodeBE4</a>（<span style="color:red">被墙</span>）</p>





        </footer>
      </div>
    </div>

    



  </body>
</html>
